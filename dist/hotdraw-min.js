// Hotdraw.js 0.1.0
//
// Copyright (c) 2004 â€“ 2015 Web Semantics,Inc. All rights reserved.
//
// http://www.opensource.org/licenses/mit-license.php
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// build: 2015-05-04

function hdChangeSelectionRectStyle(a){hdSelectionRectStyle=a}function hdChangeImageURL(a){hdImageURL=a}function createMarker(a,b,c,d){void 0==d&&(d="");var e=createSVGNode("marker",{id:a,style:"overflow:visible",refX:0,refY:0,viewBox:"0 0 10 10",markerUnits:"strokeWidth",markerWidth:4,markerHeight:3,orient:"auto"});return createSVGNode("path",{d:c,style:b,transform:d},e),df_addToDefs(e),e}function InitialiseHotDraw(){createMarker("Scissors","marker-start:none","M 9.0898857,-3.6061018 C 8.1198849,-4.7769976 6.3697607,-4.7358294 5.0623558,-4.2327734 L -3.1500488,-1.1548705 C -5.5383421,-2.4615840 -7.8983361,-2.0874077 -7.8983361,-2.7236578 C -7.8983361,-3.2209742 -7.4416699,-3.1119800 -7.5100293,-4.4068519 C -7.5756648,-5.6501286 -8.8736064,-6.5699315 -10.100428,-6.4884954 C -11.327699,-6.4958500 -12.599867,-5.5553341 -12.610769,-4.2584343 C -12.702194,-2.9520479 -11.603560,-1.7387447 -10.304005,-1.6532027 C -8.7816644,-1.4265411 -6.0857470,-2.3487593 -4.8210600,-0.082342643 C -5.7633447,1.6559151 -7.4350844,1.6607341 -8.9465707,1.5737277 C -10.201445,1.5014928 -11.708664,1.8611256 -12.307219,3.0945882 C -12.885586,4.2766744 -12.318421,5.9591904 -10.990470,6.3210002 C -9.6502788,6.8128279 -7.8098011,6.1912892 -7.4910978,4.6502760 C -7.2454393,3.4624530 -8.0864637,2.9043186 -7.7636052,2.4731223 C -7.5199917,2.1477623 -5.9728246,2.3362771 -3.2164999,1.0982979 L 5.6763468,4.2330688 C 6.8000164,4.5467672 8.1730685,4.5362646 9.1684433,3.4313614 L -0.051640930,-0.053722219 L 9.0898857,-3.6061018 z M -9.2179159,-5.5066058 C -7.9233569,-4.7838060 -8.0290767,-2.8230356 -9.3743431,-2.4433169 C -10.590861,-2.0196559 -12.145370,-3.2022863 -11.757521,-4.5207817 C -11.530373,-5.6026336 -10.104134,-6.0014137 -9.2179159,-5.5066058 z M -9.1616516,2.5107591 C -7.8108215,3.0096239 -8.0402087,5.2951947 -9.4138723,5.6023681 C -10.324932,5.9187072 -11.627422,5.4635705 -11.719569,4.3902287 C -11.897178,3.0851737 -10.363484,1.9060805 -9.1616516,2.5107591 z "),createMarker("TriangleOutS","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 5.77,0.0 L -2.88,5.0 L -2.88,-5.0 L 5.77,0.0 z ","scale(0.2)"),createMarker("TriangleOutM","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 5.77,0.0 L -2.88,5.0 L -2.88,-5.0 L 5.77,0.0 z ","scale(0.4)"),createMarker("TriangleOutL","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 5.77,0.0 L -2.88,5.0 L -2.88,-5.0 L 5.77,0.0 z ","scale(0.8)"),createMarker("TriangleInS","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 5.77,0.0 L -2.88,5.0 L -2.88,-5.0 L 5.77,0.0 z ","scale(-0.2)"),createMarker("TriangleInM","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 5.77,0.0 L -2.88,5.0 L -2.88,-5.0 L 5.77,0.0 z ","scale(-0.4)"),createMarker("TriangleInL","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 5.77,0.0 L -2.88,5.0 L -2.88,-5.0 L 5.77,0.0 z ","scale(-0.8)"),createMarker("DiamondS","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M -2.1579186e-005,-7.0710768 L -7.0710894,-8.9383918e-006 L -2.1579186e-005,7.0710589 L 7.0710462,-8.9383918e-006 L -2.1579186e-005,-7.0710768 z ","scale(0.2)"),createMarker("DiamondM","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M -2.1579186e-005,-7.0710768 L -7.0710894,-8.9383918e-006 L -2.1579186e-005,7.0710589 L 7.0710462,-8.9383918e-006 L -2.1579186e-005,-7.0710768 z ","scale(0.4)"),createMarker("DiamondL","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M -2.1579186e-005,-7.0710768 L -7.0710894,-8.9383918e-006 L -2.1579186e-005,7.0710589 L 7.0710462,-8.9383918e-006 L -2.1579186e-005,-7.0710768 z ","scale(0.8)"),createMarker("SquareS","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M -5.0,-5.0 L -5.0,5.0 L 5.0,5.0 L 5.0,-5.0 L -5.0,-5.0 z ","scale(0.2)"),createMarker("SquareM","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M -5.0,-5.0 L -5.0,5.0 L 5.0,5.0 L 5.0,-5.0 L -5.0,-5.0 z ","scale(0.4)"),createMarker("SquareL","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M -5.0,-5.0 L -5.0,5.0 L 5.0,5.0 L 5.0,-5.0 L -5.0,-5.0 z ","scale(0.8)"),createMarker("Dot_s","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none;marker-end:none","M -2.5,-1.0 C -2.5,1.7600000 -4.7400000,4.0 -7.5,4.0 C -10.260000,4.0 -12.5,1.7600000 -12.5,-1.0 C -12.5,-3.7600000 -10.260000,-6.0 -7.5,-6.0 C -4.7400000,-6.0 -2.5,-3.7600000 -2.5,-1.0 z ","scale(0.2) translate(7.125493, 1)"),createMarker("Dot_m","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none;marker-end:none","M -2.5,-1.0 C -2.5,1.7600000 -4.7400000,4.0 -7.5,4.0 C -10.260000,4.0 -12.5,1.7600000 -12.5,-1.0 C -12.5,-3.7600000 -10.260000,-6.0 -7.5,-6.0 C -4.7400000,-6.0 -2.5,-3.7600000 -2.5,-1.0 z ","scale(0.4) translate(7.125493, 1)"),createMarker("Dot_l","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none;marker-end:none","M -2.5,-1.0 C -2.5,1.7600000 -4.7400000,4.0 -7.5,4.0 C -10.260000,4.0 -12.5,1.7600000 -12.5,-1.0 C -12.5,-3.7600000 -10.260000,-6.0 -7.5,-6.0 C -4.7400000,-6.0 -2.5,-3.7600000 -2.5,-1.0 z ","scale(0.8) translate(7.125493, 1)");var a=createSVGNode("marker",{id:"Tail",style:"overflow:visible",refX:0,refY:0,viewBox:"0 0 10 10",markerUnits:"strokeWidth",markerWidth:4,markerHeight:3,orient:"auto"}),b=createSVGNode("g",{transform:"scale(-1.2)"},a);createSVGNode("path",{d:"M -3.8048674,-3.9585227 L 0.54352094,-0.00068114835",style:"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;marker-start:none;marker-end:none;stroke-linecap:round",transform:""},b),createSVGNode("path",{d:"M -1.2866832,-3.9585227 L 3.0617053,-0.00068114835",style:"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;marker-start:none;marker-end:none;stroke-linecap:round",transform:""},b),createSVGNode("path",{d:"M 1.3053582,-3.9585227 L 5.6537466,-0.00068114835",style:"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;marker-start:none;marker-end:none;stroke-linecap:round",transform:""},b),createSVGNode("path",{d:"M -3.8048674,4.1775838 L 0.54352094,0.21974226",style:"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;marker-start:none;marker-end:none;stroke-linecap:round",transform:""},b),createSVGNode("path",{d:"M -1.2866832,4.1775838 L 3.0617053,0.21974226",style:"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;marker-start:none;marker-end:none;stroke-linecap:round",transform:""},b),createSVGNode("path",{d:"M 1.3053582,4.1775838 L 5.6537466,0.21974226",style:"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;marker-start:none;marker-end:none;stroke-linecap:round",transform:""},b),df_addToDefs(a),createMarker("Arrow2Sstart","font-size:12.0;fill-rule:evenodd;stroke-width:0.62500000;stroke-linejoin:round","M 8.7185878,4.0337352 L -2.2072895,0.016013256 L 8.7185884,-4.0017078 C 6.9730900,-1.6296469 6.9831476,1.6157441 8.7185878,4.0337352 z ","scale(0.3) translate(-5,0)"),createMarker("Arrow2Mstart","font-size:12.0;fill-rule:evenodd;stroke-width:0.62500000;stroke-linejoin:round","M 8.7185878,4.0337352 L -2.2072895,0.016013256 L 8.7185884,-4.0017078 C 6.9730900,-1.6296469 6.9831476,1.6157441 8.7185878,4.0337352 z ","scale(0.6) translate(-5,0)"),createMarker("Arrow2Lstart","font-size:12.0;fill-rule:evenodd;stroke-width:0.62500000;stroke-linejoin:round","M 8.7185878,4.0337352 L -2.2072895,0.016013256 L 8.7185884,-4.0017078 C 6.9730900,-1.6296469 6.9831476,1.6157441 8.7185878,4.0337352 z ","scale(1.1) translate(-5,0)"),createMarker("Arrow2Send","font-size:12.0;fill-rule:evenodd;stroke-width:0.62500000;stroke-linejoin:round;","M 8.7185878,4.0337352 L -2.2072895,0.016013256 L 8.7185884,-4.0017078 C 6.9730900,-1.6296469 6.9831476,1.6157441 8.7185878,4.0337352 z ","scale(0.3) rotate(180) translate(-5,0)"),createMarker("Arrow2Mend","font-size:12.0;fill-rule:evenodd;stroke-width:0.62500000;stroke-linejoin:round;","M 8.7185878,4.0337352 L -2.2072895,0.016013256 L 8.7185884,-4.0017078 C 6.9730900,-1.6296469 6.9831476,1.6157441 8.7185878,4.0337352 z ","scale(0.6) rotate(180) translate(-5,0)"),createMarker("Arrow2Lend","font-size:12.0;fill-rule:evenodd;stroke-width:0.62500000;stroke-linejoin:round;","M 8.7185878,4.0337352 L -2.2072895,0.016013256 L 8.7185884,-4.0017078 C 6.9730900,-1.6296469 6.9831476,1.6157441 8.7185878,4.0337352 z ","scale(1.1) rotate(180) translate(-5,0)"),createMarker("Arrow1Sstart","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 0.0,0.0 L 5.0,-5.0 L -12.5,0.0 L 5.0,5.0 L 0.0,0.0 z ","scale(0.2)"),createMarker("Arrow1Mstart","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 0.0,0.0 L 5.0,-5.0 L -12.5,0.0 L 5.0,5.0 L 0.0,0.0 z ","scale(0.4)"),createMarker("Arrow1Lstart","fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;marker-start:none","M 0.0,0.0 L 5.0,-5.0 L -12.5,0.0 L 5.0,5.0 L 0.0,0.0 z ","scale(0.8)"),setBackgroundPatterns()}function setBackgroundPatterns(){var a;pattern=createSVGNode("pattern",{id:"bg_grid",x:0,y:0,width:12,height:12,overflow:"visible",patternUnits:"userSpaceOnUse",preserveAspectRatio:"xMidYMid meet"}),pattern.appendChild(createSVGNode("rect",{x:0,y:0,width:12,height:12,style:"stroke:#D1E3F6;stroke-width:1;fill:white"})),df_addToDefs(pattern),pattern=createSVGNode("pattern",{id:"bg_mesh",x:0,y:0,width:64,height:64,overflow:"visible",patternUnits:"userSpaceOnUse",preserveAspectRatio:"xMidYMid meet"}),pattern.appendChild(createSVGNode("circle",{cx:32,cy:32,r:28,style:"stroke:none;stroke-width:0;fill:white"})),df_addToDefs(pattern),a=createSVGNode("linearGradient",{id:"bg_whiteVerticalLinearColor",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}),a.appendChild(createSVGNode("stop",{offset:"0%","stop-color":"#E1EBF0"})),a.appendChild(createSVGNode("stop",{offset:"100%","stop-color":"rgb(255,255,255)"})),df_addToDefs(a),pattern=createSVGNode("pattern",{id:"bg_isometric",x:0,y:0,width:174.6957398,height:262.4999313,overflow:"visible",patternUnits:"userSpaceOnUse",preserveAspectRatio:"xMidYMid meet"}),pattern.appendChild(createSVGNode("rect",{x:0,y:0,width:195.6957398,height:262.4999313,style:"stroke:none;stroke-width:0;fill:#6AC60D"})),pattern.appendChild(createSVGNode("rect",{x:97.8478699,y:-43.74998855,width:97.8478699,height:87.4999771,transform:"matrix(0.894246,0.447576,0,1,0,0)",style:"stroke:none;stroke-width:0;fill:#4FA019"})),pattern.appendChild(createSVGNode("rect",{x:0,y:43.74998855,width:97.8479004,height:87.4999771,transform:"matrix(0.894246,-0.447577,0,1,0,0)",style:"stroke:none;stroke-width:0;fill:#65B821"})),pattern.appendChild(createSVGNode("rect",{x:0,y:131.24996564999998,width:97.8478699,height:87.4999771,transform:"matrix(0.894246,0.447576,0,1,0,0)",style:"stroke:none;stroke-width:0;fill:#4FA019"})),pattern.appendChild(createSVGNode("rect",{x:97.8478699,y:218.74994275,width:97.8479004,height:87.4999771,transform:"matrix(0.894246,-0.447577,0,1,0,0)",style:"stroke:none;stroke-width:0;fill:#65B821"})),df_addToDefs(pattern)}function Figure(){{var a=Figure.arguments;Figure.length}this.className="Figure",a.length>0&&this.initFigure()}function Drawing(){{var a=Drawing.arguments;Drawing.length}this.className="Drawing",a.length>0&&this.initDrawing()}function FigureEnumeration(){{var a=FigureEnumeration.arguments;FigureEnumeration.length}this.className="FigureEnumeration",a.length>0&&this.initFigureEnumeration()}function FigureChangeListener(){}function DrawingChangeListener(){}function FigureChangeEvent(a,b){{var c=FigureChangeEvent.arguments;FigureChangeEvent.length}this.className="FigureChangeEvent",this.fRectangle=null,this.fgEmptyRectangle=new gRectangle(0,0,0,0),c.length>0&&this.initFigureChangeEvent(a,b)}function DrawingChangeEvent(a,b){{var c=DrawingChangeEvent.arguments;DrawingChangeEvent.length}this.className="DrawingChangeEvent",this.fRectangle=null,this.fgEmptyRectangle=new gRectangle(0,0,0,0),c.length>0&&this.initDrawingChangeEvent(a,b)}function Tool(){this.className="Tool"}function DrawingView(){this.className="DrawingView"}function DrawingEditor(){this.className="DrawingEditor"}function Handle(){this.className="Handle",this.HANDLESIZE=8}function Locator(){this.className="Locator"}function ReverseVectorEnumerator(a){{var b=ReverseVectorEnumerator.arguments;ReverseVectorEnumerator.length}this.className="ReverseVectorEnumerator",this.vector=new Vector,this.count=0,b.length>0&&this.initReverseVectorEnumerator(a)}function PaletteButton(a){{var b=PaletteButton.arguments;PaletteButton.length}this.className="PaletteButton",this.fListener=null,this.fState=0,this.fOldState=0,b.length>0&&this.initPaletteButton(a)}function Command(a){{var b=Command.arguments;Command.length}this.className="Command",this.fName=null,b.length>0&&this.initCommand(a)}function FloatingTextField(){{var a=FloatingTextField.arguments;FloatingTextField.length}this.className="FloatingTextField",this.fEditWidget=null,this.fContainer=null,a.length>=0&&this.initFloatingTextField()}function Geom(){{var a=Geom.arguments;Geom.length}this.className="Geom",this.NORTH=1,this.SOUTH=2,this.WEST=3,this.EAST=4,a.length>0&&this.initGeom()}function FigureTransferCommand(a,b){{var c=FigureTransferCommand.arguments;FigureTransferCommand.length}this.className="Command",this.fView=null,c.length>0&&this.initFigureTransferCommand(a,b)}function DeleteCommand(a,b){{var c=DeleteCommand.arguments;DeleteCommand.length}this.className="Command",this.fView=null,c.length>0&&this.initDeleteCommand(a,b)}function DuplicateCommand(a,b){{var c=DuplicateCommand.arguments;DuplicateCommand.length}this.className="Command",this.fView=null,c.length>0&&this.initDuplicateCommand(a,b)}function GroupCommand(a,b){{var c=GroupCommand.arguments;GroupCommand.length}this.className="Command",this.fView=null,c.length>0&&this.initGroupCommand(a,b)}function UngroupCommand(a,b){{var c=UngroupCommand.arguments;UngroupCommand.length}this.className="Command",this.fView=null,c.length>0&&this.initUngroupCommand(a,b)}function FigureEnumerator(a){{var b=FigureEnumerator.arguments;FigureEnumerator.length}this.className="FigureEnumerator",this.fEnumeration=null,b.length>0&&this.initFigureEnumerator(a)}function ReverseFigureEnumerator(a){{var b=ReverseFigureEnumerator.arguments;ReverseFigureEnumerator.length}this.className="ReverseFigureEnumerator",this.fEnumeration=null,b.length>0&&this.initReverseFigureEnumerator(a)}function FigureChangeEventMulticaster(a,b){{var c=FigureChangeEventMulticaster.arguments;FigureChangeEventMulticaster.length}this.className="FigureChangeEventMulticaster",this.a=null,this.b=null,c.length>0&&this.initFigureChangeEventMulticaster(a,b)}function AbstractFigure(){{var a=AbstractFigure.arguments;AbstractFigure.length}this.className="AbstractFigure",this.id=null,this.myCount=0,this.counter=new Array(0),this.fListener=null,this.shape=null,this.created=!1,a.length>0&&this.initAbstractFigure()}function cloneObject(a){for(i in a)"object"==typeof a[i]?this[i]=new cloneObject(a[i]):this[i]=a[i]}function getCompositeFigureId(){return common_composite_figure_id+cocomposite_figure_counter++}function CompositeFigure(){{var a=CompositeFigure.arguments;CompositeFigure.length}this.className="CompositeFigure",this.fFigures=null,this.g=null,a.length>0&&this.initCompositeFigure()}function StandardDrawing(){{var a=StandardDrawing.arguments;StandardDrawing.length}this.className="StandardDrawing",this.fListeners=null,this.fDrawingLockHolder=null,a.length>0&&this.initStandardDrawing()}function AbstractTool(a){{var b=AbstractTool.arguments;AbstractTool.length}this.className="AbstractTool",this.fView=null,this.fAnchorX=0,this.fAnchorY=0,b.length>0&&this.initAbstractTool(a)}function SelectionTool(a){{var b=SelectionTool.arguments;SelectionTool.length}this.className="SelectionTool",this.fChild=null,b.length>0&&this.initSelectionTool(a)}function StandardDrawingView(a,b,c){{var d=StandardDrawingView.arguments;StandardDrawingView.length}this.className="StandardDrawingView",this.fEditor=null,this.fDrawing=null,this.fDamage=null,this.fSelection=null,this.fSelectionHandles=null,this.fViewSize=null,this.fLastClick=null,this.fBackgrounds=null,this.fForegrounds=null,this.fUpdateStrategy=null,this.viewcontentg=null,this.selectiong=null,this.textBoxg=null,this.fConstrainer=null,d.length>0&&this.initStandardDrawingView(a,b,c)}function ToolButton(a,b,c,d){{var e=ToolButton.arguments;ToolButton.length}this.className="ToolButton",this.fName=null,this.fTool=null,this.fIcon=null,e.length>0&&this.initToolButton(a,b,c,d)}function PaletteIcon(a,b,c,d){{var e=PaletteIcon.arguments;PaletteIcon.length}this.className="PaletteIcon",this.fNormal=null,this.fPressed=null,this.fSelected=null,this.fName=null,e.length>0&&this.initPaletteIcon(a,b,c,d)}function SelectAreaTracker(a){{var b=SelectAreaTracker.arguments;SelectAreaTracker.length}this.className="SelectAreaTracker",this.fSelectGroup=null,this.shape=null,b.length>0&&this.initSelectAreaTracker(a)}function CreationTool(a,b){{var c=CreationTool.arguments;CreationTool.length}this.className="CreationTool",this.fAnchorPoint=null,this.fCreatedFigure=null,this.fPrototype=null,c.length>0&&this.initCreationTool(a,b)}function ScribbleTool(a){{var b=ScribbleTool.arguments;ScribbleTool.length}this.className="ScribbleTool",this.fScribble=null,this.fLastX=null,this.fLastY=null,b.length>0&&this.initScribbleTool(a)}function DragTracker(a,b){{var c=DragTracker.arguments;DragTracker.length}this.className="DragTracker",this.fAnchorFigure=null,this.fLastX=null,this.fLastY=null,this.fMoved=null,c.length>0&&this.initDragTracker(a,b)}function AbstractHandle(a){{var b=AbstractHandle.arguments;AbstractHandle.length}this.className="AbstractHandle",this.color="yellow",this.fOwner=null,this.shape=null,this.created=!1,this.HANDLESIZE=8,b.length>0&&this.initAbstractHandle(a)}function LocatorHandle(a,b){{var c=LocatorHandle.arguments;LocatorHandle.length}this.className="LocatorHandle",this.fLocator=null,c.length>0&&this.initLocatorHandle(a,b)}function RadiusHandle(a){{var b=RadiusHandle.arguments;RadiusHandle.length}this.className="RadiusHandle",this.fRadius=null,this.fOwner=null,this.OFFSET=4,b.length>0&&this.initRadiusHandle(a)}function HandleTracker(a,b){{var c=HandleTracker.arguments;HandleTracker.length}this.className="HandleTracker",this.fAnchorHandle=null,c.length>0&&this.initHandleTracker(a,b)}function AbstractLocator(){this.className="AbstractLocator"}function RelativeLocator(a,b){{var c=RelativeLocator.arguments;RelativeLocator.length}this.className="RelativeLocator",this.fRelativeX=0,this.fRelativeY=0,c.length>0&&this.initRelativeLocator(a,b)}function NorthEastHandle(a){{var b=NorthEastHandle.arguments;NorthEastHandle.length}this.className="NorthEastHandle",b.length>0&&this.initNorthEastHandle(a)}function EastHandle(a){{var b=EastHandle.arguments;EastHandle.length}this.className="EastHandle",b.length>0&&this.initEastHandle(a)}function NorthHandle(a){{var b=NorthHandle.arguments;NorthHandle.length}this.className="NorthHandle",b.length>0&&this.initNorthHandle(a)}function NorthWestHandle(a){{var b=NorthWestHandle.arguments;NorthWestHandle.length}this.className="NorthWestHandle",b.length>0&&this.initNorthWestHandle(a)}function SouthEastHandle(a){{var b=SouthEastHandle.arguments;SouthEastHandle.length}this.className="SouthEastHandle",b.length>0&&this.initSouthEastHandle(a)}function SouthHandle(a){{var b=SouthHandle.arguments;SouthHandle.length}this.className="SouthHandle",b.length>0&&this.initSouthHandle(a)}function SouthWestHandle(a){{var b=SouthWestHandle.arguments;SouthWestHandle.length}this.className="SouthWestHandle",b.length>0&&this.initSouthWestHandle(a)}function WestHandle(a){{var b=WestHandle.arguments;WestHandle.length}this.className="WestHandle",b.length>0&&this.initWestHandle(a)}function BoxHandleKit(){{var a=BoxHandleKit.arguments;BoxHandleKit.length}this.className="BoxHandleKit",a.length>0&&this.initBoxHandleKit()}function TextHolder(){this.className="TextHolder"}function NullHandle(a,b){{var c=NullHandle.arguments;NullHandle.length}this.className="NullHandle",c.length>0&&this.initNullHandle(a,b)}function ActionTool(a){{var b=ActionTool.arguments;ActionTool.length}this.className="ActionTool",b.length>0&&this.initActionTool(a)}function FigureAttributes(){{var a=FigureAttributes.arguments;FigureAttributes.length}this.className="FigureAttributes",this.fMap=new Hashtable,a.length>0&&this.initFigureAttributes()}function AttributeFigure(){{var a=AttributeFigure.arguments;AttributeFigure.length}this.className="AttributeFigure",this.fgDefaultAttributes=null,this.fAttributes=null,a.length>0&&this.initAttributeFigure()}function DecoratorFigure(a){{var b=DecoratorFigure.arguments;DecoratorFigure.length}this.className="DecoratorFigure",this.fComponent=null,b.length>0&&this.initDecoratorFigure(a)}function RectangleFigure(a,b){{var c=RectangleFigure.arguments;RectangleFigure.length}this.className="RectangleFigure",this.fDisplayBox=null,c.length>0&&this.initRectangleFigure(a,b)}function PolyLineFigure(a,b){{var c=PolyLineFigure.arguments;PolyLineFigure.length}this.className="PolyLineFigure",this.d="M -1 -1",this.shape=null,this.fPoints=null,this.fStartDecoration=null,this.fEndDecoration=null,this.fFrameColor="black",this.fFrameWidth=1,this.fOpacity=1,this.pathChanged=!1,c.length>0&&this.initPolyLineFigure(a,b)}function EllipseFigure(a,b){{var c=EllipseFigure.arguments;EllipseFigure.length}this.className="EllipseFigure",this.fDisplayBox=null,c.length>0&&this.initEllipseFigure(a,b)}function ImageFigure(a,b,c){{var d=ImageFigure.arguments;ImageFigure.length}this.className="ImageFigure",this.fFileName=null,this.preserveAspectRatio="none",d.length>0&&this.initImageFigure(a,b,c)}function RoundRectangleFigure(a,b){{var c=RoundRectangleFigure.arguments;RoundRectangleFigure.length}this.className="RoundRectangleFigure",this.fDisplayBox=null,this.DEFAULT_ARC=15,this.fArcWidth=this.DEFAULT_ARC,this.fArcHeight=this.DEFAULT_ARC,c.length>0&&this.initRoundRectangleFigure(a,b)}function TextFigure(){{var a=TextFigure.arguments;TextFigure.length}this.className="TextFigure",this.fOriginX=0,this.fOriginY=0,this.fSizeIsDirty=!0,this.fWidth=0,this.fHeight=0,this.fText="",this.fIsReadOnly=!1,this.fObservedFigure=null,this.fLocator=null,this.fgCurrentFontName="Helvetica",this.fgCurrentFontSize=10,this.fgCurrentFontStyle="Normal",this.fFont=this.createCurrentFont(),a.length>0&&this.initTextFigure()}function TextTool(a,b){{var c=TextTool.arguments;TextTool.length}this.className="TextTool",this.fTextField=null,this.fTypingTarget=null,c.length>0&&this.initTextTool(a,b)}function FontSizeHandle(a,b){{var c=FontSizeHandle.arguments;FontSizeHandle.length}this.className="FontSizeHandle",this.fFont=null,this.fSize=0,this.color="yellow",c.length>0&&this.initFontSizeHandle(a,b)}function PolyLineHandle(a,b,c){{var d=PolyLineHandle.arguments;PolyLineHandle.length}this.className="PolyLineHandle",this.fAnchor=null,this.fIndex=0,d.length>0&&this.initPolyLineHandle(a,b,c)}function PolyLineLocator(a){this.className="PolyLineLocator",this.fIndex=0,this.initPolyLineLocator(a)}function LineFigure(){{var a=LineFigure.arguments;LineFigure.length}this.className="LineFigure",a.length>0&&this.initLineFigure()}function BorderDecorator(a){{var b=BorderDecorator.arguments;BorderDecorator.length}this.className="BorderDecorator",b.length>0&&this.initBorderDecorator(a)}function BorderTool(a){{var b=BorderTool.arguments;BorderTool.length}this.className="BorderTool",b.length>0&&this.initBorderTool(a)}function GroupFigure(){{var a=GroupFigure.arguments;GroupFigure.length}this.className="GroupFigure",a.length>=0&&this.initGroupFigure()}function GroupHandle(a,b){{var c=GroupHandle.arguments;GroupHandle.length}this.className="GroupHandle",c.length>0&&this.initGroupHandle(a,b)}function PolygonFigure(a,b){{var c=PolygonFigure.arguments;PolygonFigure.length}this.className="PolygonFigure",this.fPoly=null,c.length>0&&this.initPolygonFigure(a,b)}function PolygonFigureLocator(a){this.className="PolygonFigureLocator",this.pointIndex=a}function PolygonHandle(a,b,c){{var d=PolygonHandle.arguments;PolygonHandle.length}this.className="PolygonHandle",this.fLocator=null,this.fIndex=0,d.length>0&&this.initPolygonHandle(a,b,c)}function PolygonTool(a){{var b=PolygonTool.arguments;PolygonTool.length}this.className="PolygonTool",this.fPolygon=null,this.fLastX=null,this.fLastY=null,b.length>0&&this.initPolygonTool(a)}function PolygonScaleHandle(a){{var b=PolygonScaleHandle.arguments;PolygonScaleHandle.length}this.className="PolygonScaleHandle",this.fOrigin=null,this.fCurrent=null,this.fOrigPoly=null,b.length>0&&this.initPolygonScaleHandle(a)}function FloatingTextArea(){{var a=FloatingTextArea.arguments;FloatingTextArea.length}this.className="FloatingTextArea",this.fEditWidget=null,this.fContainer=null,a.length>=0&&this.initFloatingTextArea()}function TextAreaTool(a,b){{var c=TextAreaTool.arguments;TextAreaTool.length}this.className="TextAreaTool",this.fTextAreaField=null,this.fTypingTarget=null,this.textHolderDefaultWidth=300,this.textHolderDefaultHeight=300,c.length>0&&this.initTextAreaTool(a,b)}function OpacityHandle(a,b){{var c=OpacityHandle.arguments;OpacityHandle.length}this.className="OpacityHandle",this.opacity=0,this.min=-100,this.max=100,c.length>0&&this.initOpacityHandle(a,b)}function TextAlignHandle(a,b){{var c=TextAlignHandle.arguments;TextAlignHandle.length}this.className="TextAlignHandle",this.textAlign={0:"left",1:"right",2:"center",3:"justify"},this.counter=0,c.length>0&&this.initTextAlignHandle(a,b)}function TextAreaDecorator(a){{var b=TextAreaDecorator.arguments;TextAreaDecorator.length}this.className="TextAreaDecorator",this.fIsReadOnly=!1,this.fText="SVG HotDraw is a two-dimensional graphics framework for structured drawing editors that is written in JavaScript for SVG. It has been used to create many different editors from CASE tools to a HyperCard clone. You can easily create new figures and special manipulation tools for your drawings.",this.fgCurrentFontName="Helvetica",this.fgCurrentFontSize=14,this.fgCurrentFontStyle="Normal",this.fFont=this.createCurrentFont(),this.para=null,b.length>0&&this.initTextAreaDecorator(a)}function DrawApplication(){DrawApplication.arguments,DrawApplication.length;this.name="DrawApplication",this.className="DrawApplication",this.fDrawing=null,this.fTool=null,this.fIconkit=null,this.fStatusLine=null,this.fView=null,this.fDefaultToolButton=null,this.fSelectedToolButton=null,this.fDrawingFilename=null,this.fgUntitled="untitled",this.fgDrawPath="",this.IMAGES=this.fgDrawPath+"../../img/"}function DemoDrawingView(a,b,c){{var d=DemoDrawingView.arguments;DemoDrawingView.length}this.className="DemoDrawingView",this.changeEventFlag=!0,this.targetFigure=!0,this.popUpMenu2=null,d.length>0&&this.initDemoDrawingView(a,b,c)}function DemoApplication(){DemoApplication.arguments,DemoApplication.length;this.name="DemoApplication",this.className="DemoApplication",this.figures=new Hashtable,this._curFig=null,this.tools=null,this.attributesWindow=null}function DemoAttributes(a,b){{var c=DemoAttributes.arguments;DemoAttributes.length}this.name="DemoAttributes",this.className="DemoAttributes",this.selected=null,this.imageURL=null,this.fontComboBox=null,this.fillColorLabel=null,this.strokeColorLabel=null,this.fillColorComboBox=null,this.strokeColorComboBox=null,this.modified=null,this.cw=520,this.ch=145,c.length>0&&this.initDemoAttributes(a,b)}function runHotdrawjs(){userName="User("+Math.floor(1e3*Math.random())+")",initialise(),InitialiseHotDraw(),ds_getDesktop().setColor("#C0C0C0"),hdChangeImageURL("../../img/joe.surf.yellow.small.gif"),run()}function run(){demoApplication=new DemoApplication,demoApplication.open(0,0,innerWidth,innerHeight),demoApplication.recalc()}var hdSelectionRectStyle="stroke-linecap:round;fill:none;opacity:0.8;stroke:black;stroke-width:1",hdImageURL="../img/joe.surf.yellow.small.gif";Figure.prototype.initFigure=function(){},Figure.prototype.moveBy=function(a,b){},Figure.prototype.basicDisplayBox=function(a,b){},Figure.prototype.displayBox=function(a,b){},Figure.prototype.displayBox=function(a,b){},Figure.prototype.draw=function(a){},Figure.prototype.handles=function(){},Figure.prototype.size=function(){},Figure.prototype.center=function(){},Figure.prototype.isEmpty=function(){},Figure.prototype.figures=function(){},Figure.prototype.findFigureInside=function(a,b){},Figure.prototype.containsPoint=function(a,b){},Figure.prototype.clone=function(a,b){},Figure.prototype.displayBox=function(a){},Figure.prototype.includes=function(a){},Figure.prototype.decompose=function(){},Figure.prototype.addToContainer=function(a){},Figure.prototype.removeFromContainer=function(a){},Figure.prototype.listener=function(){},Figure.prototype.addFigureChangeListener=function(a){},Figure.prototype.removeFigureChangeListener=function(a){},Figure.prototype.release=function(){},Figure.prototype.invalidate=function(){},Figure.prototype.willChange=function(){},Figure.prototype.changed=function(){},Figure.prototype.canConnect=function(){},Figure.prototype.connectorAt=function(a,b){},Figure.prototype.connectorVisibility=function(a){},Figure.prototype.connectionInsets=function(){},Figure.prototype.connectedTextLocator=function(a){},Figure.prototype.getAttribute=function(a){},Figure.prototype.setAttribute=function(a,b){},Drawing.prototype.initDrawing=function(){},Drawing.prototype.release=function(){},Drawing.prototype.figures=function(){},Drawing.prototype.figuresReverse=function(){},Drawing.prototype.findFigure=function(a,b){},Drawing.prototype.findFigureWithout=function(a,b,c){},Drawing.prototype.findFigureInside=function(a,b){},Drawing.prototype.findFigureInsideWithout=function(a,b,c){},Drawing.prototype.addDrawingChangeListener=function(a){},Drawing.prototype.removeDrawingChangeListener=function(a){},Drawing.prototype.drawingChangeListeners=function(){},Drawing.prototype.add=function(a){},Drawing.prototype.addAll=function(a){},Drawing.prototype.remove=function(a){},Drawing.prototype.orphan=function(a){},Drawing.prototype.orphanAll=function(a){},Drawing.prototype.removeAll=function(a){},Drawing.prototype.replace=function(a,b){},Drawing.prototype.sendToBack=function(a){},Drawing.prototype.bringToFront=function(a){},Drawing.prototype.draw=function(a){},Drawing.prototype.figureInvalidated=function(a){},Drawing.prototype.figureRequestUpdate=function(a){},Drawing.prototype.figureRequestRemove=function(a){},Drawing.prototype.lock=function(){},Drawing.prototype.unlock=function(){},FigureEnumeration.prototype=new Enumeration,FigureEnumeration.prototype.initFigureEnumeration=function(){},FigureEnumeration.prototype.nextFigure=function(){},FigureChangeListener.prototype=new EventListener,FigureChangeListener.prototype.figureInvalidated=function(a){},FigureChangeListener.prototype.figureChanged=function(a){},FigureChangeListener.prototype.figureRemoved=function(a){},FigureChangeListener.prototype.figureRequestRemove=function(a){},FigureChangeListener.prototype.figureRequestUpdate=function(a){},DrawingChangeListener.prototype=new EventListener,DrawingChangeListener.prototype.drawingInvalidated=function(a){},DrawingChangeListener.prototype.drawingRequestUpdate=function(a){},FigureChangeEvent.prototype=new EventObject,FigureChangeEvent.prototype.initFigureChangeEvent=function(a,b){this.initEventObject(a),void 0==b?this.fRectangle=this.fgEmptyRectangle:this.fRectangle=b},FigureChangeEvent.prototype.getFigure=function(){return this.getSource()},FigureChangeEvent.prototype.getInvalidatedRectangle=function(){return this.fRectangle},DrawingChangeEvent.prototype=new EventObject,DrawingChangeEvent.prototype.initDrawingChangeEvent=function(a,b){this.initEventObject(a),void 0==b?this.fRectangle=this.fgEmptyRectangle:this.fRectangle=b},DrawingChangeEvent.prototype.getDrawing=function(){return this.getSource()},DrawingChangeEvent.prototype.getInvalidatedRectangle=function(){return this.fRectangle},Tool.prototype.activate=function(){},
Tool.prototype.deactivate=function(){},Tool.prototype.mouseDown=function(a,b,c){},Tool.prototype.mouseDrag=function(a,b,c){},Tool.prototype.mouseUp=function(a,b,c){},Tool.prototype.mouseMove=function(a,b,c){},Tool.prototype.keyDown=function(a,b,c){},DrawingView.prototype=new DrawingChangeListener,DrawingView.prototype.setEditor=function(a){},DrawingView.prototype.tool=function(){},DrawingView.prototype.drawing=function(){},DrawingView.prototype.setDrawing=function(a){},DrawingView.prototype.editor=function(){},DrawingView.prototype.add=function(a){},DrawingView.prototype.remove=function(a){},DrawingView.prototype.addAll=function(a){},DrawingView.prototype.getSize=function(){},DrawingView.prototype.getMinimumSize=function(){},DrawingView.prototype.getPreferredSize=function(){},DrawingView.prototype.setDisplayUpdate=function(a){},DrawingView.prototype.selection=function(){},DrawingView.prototype.selectionElements=function(){},DrawingView.prototype.selectionZOrdered=function(){},DrawingView.prototype.selectionCount=function(){},DrawingView.prototype.addToSelection=function(a){},DrawingView.prototype.addToSelectionAll=function(a){},DrawingView.prototype.removeFromSelection=function(a){},DrawingView.prototype.toggleSelection=function(a){},DrawingView.prototype.clearSelection=function(){},DrawingView.prototype.getFigureSelection=function(){},DrawingView.prototype.findHandle=function(a,b){},DrawingView.prototype.lastClick=function(){},DrawingView.prototype.setConstrainer=function(a){},DrawingView.prototype.getConstrainer=function(){},DrawingView.prototype.checkDamage=function(){},DrawingView.prototype.repairDamage=function(){},DrawingView.prototype.paint=function(a){},DrawingView.prototype.createImage=function(a,b){},DrawingView.prototype.getGraphics=function(){},DrawingView.prototype.getBackground=function(){},DrawingView.prototype.setBackground=function(a){},DrawingView.prototype.drawAll=function(a){},DrawingView.prototype.drawHandles=function(a){},DrawingView.prototype.drawDrawing=function(a){},DrawingView.prototype.drawBackground=function(a){},DrawingView.prototype.setCursor=function(a){},DrawingView.prototype.freezeView=function(){},DrawingView.prototype.unfreezeView=function(){},DrawingEditor.prototype.view=function(){},DrawingEditor.prototype.drawing=function(){},DrawingEditor.prototype.tool=function(){},DrawingEditor.prototype.toolDone=function(){},DrawingEditor.prototype.selectionChanged=function(a){},DrawingEditor.prototype.showStatus=function(a){},Handle.prototype.locate=function(){},Handle.prototype.invokeStart=function(a,b,c){},Handle.prototype.invokeStep=function(a,b,c,d,e){},Handle.prototype.invokeEnd=function(a,b,c,d,e){},Handle.prototype.owner=function(){},Handle.prototype.displayBox=function(){},Handle.prototype.containsPoint=function(a,b){},Handle.prototype.draw=function(a){},Locator.prototype.locate=function(a){},ReverseVectorEnumerator.prototype=new Enumeration,ReverseVectorEnumerator.prototype.initReverseVectorEnumerator=function(a){this.vector=a,this.count=this.vector.size()-1},ReverseVectorEnumerator.prototype.hasMoreElements=function(){return this.count>=0},ReverseVectorEnumerator.prototype.nextElement=function(){return this.count>=0?this.vector.elementAt(this.count--):void 0};var NORMAL=1,PRESSED=2,SELECTED=3;PaletteButton.prototype=new Canvas,PaletteButton.prototype.initPaletteButton=function(a){this.initCanvas(0,0,24,24),this.fListener=a,this.fState=NORMAL,this.fOldState=NORMAL,this.addMouseMotionListener(this),this.addMouseListener(this)},PaletteButton.prototype.createSVGContent=function(){this.createSVGContentPaletteButton(g)},PaletteButton.prototype.createSVGContentPaletteButton=function(){this.createSVGContentCanvas()},PaletteButton.prototype.mouseDragged=function(a){this.fState=PRESSED,this.refresh()},PaletteButton.prototype.mouseMoved=function(a){this.fListener.paletteUserOver(this,!0)},PaletteButton.prototype.mouseClicked=function(a){},PaletteButton.prototype.mousePressed=function(a){this.fOldState=this.fState,this.fState=PRESSED,this.refresh()},PaletteButton.prototype.mouseReleased=function(a){this.fState=this.fOldState,this.fListener.paletteUserSelected(this),this.refresh()},PaletteButton.prototype.mouseEndDragged=function(a){this.fState=PRESSED,this.mouseReleased()},PaletteButton.prototype.mouseEntered=function(a){},PaletteButton.prototype.mouseExited=function(a){this.fState==PRESSED&&this.mouseDragged(a),this.fListener.paletteUserOver(this,!1)},PaletteButton.prototype.paintBackground=function(a){},PaletteButton.prototype.paintNormal=function(a){},PaletteButton.prototype.paintPressed=function(a){},PaletteButton.prototype.paintSelected=function(a){},PaletteButton.prototype.value=function(){return null},PaletteButton.prototype.name=function(){return""},PaletteButton.prototype.reset=function(){this.fState=NORMAL,this.refresh()},PaletteButton.prototype.select=function(){this.fState=SELECTED,this.refresh()},PaletteButton.prototype.update=function(a){this.refresh(a)},PaletteButton.prototype.refresh=function(a){switch(this.paintBackground(a),this.fState){case PRESSED:this.paintPressed(a);break;case SELECTED:this.paintSelected(a);break;case NORMAL:default:this.paintNormal(a)}},Command.prototype.initCommand=function(a){this.fName=a},Command.prototype.execute=function(){},Command.prototype.isExecutable=function(){return!0},Command.prototype.name=function(){return this.fName},Command.prototype.toString=function(){return this.className+" [ name="+this.fName+" ]"},FloatingTextField.prototype.initFloatingTextField=function(){this.fEditWidget=new TextBox(0,0,400,100,"Text",!1),this.fEditWidget.setAbsolutePosition(!0)},FloatingTextField.prototype.createOverlay=function(a,b){return void 0==b?void this.createOverlay(a,null):(this.fEditWidget.show(),a.add(this.fEditWidget),null!=b&&this.fEditWidget.setFont(b),this.fContainer=a,this.fContainer.paintChildren(this.fContainer.textBoxg),this.fEditWidget.setStyledModeOn(),void this.fEditWidget.changeSelectionRectStyle("red","none",0))},FloatingTextField.prototype.setBounds=function(a,b){this.fEditWidget.setBounds(a.x,a.y,a.width,a.height),this.fEditWidget.show(),this.fEditWidget.setText(b),this.fEditWidget.selectAll()},FloatingTextField.prototype.getBounds=function(){return this.fEditWidget.getBounds()},FloatingTextField.prototype.isShown=function(){return this.fEditWidget.isShown()},FloatingTextField.prototype.endOverlay=function(){null!=this.fEditWidget&&(this.fEditWidget.hide(),this.fContainer.remove(this.fEditWidget))},FloatingTextField.prototype.addActionListener=function(a){this.fEditWidget.addActionListener(a)},FloatingTextField.prototype.removeActionListener=function(a){this.fEditWidget.removeActionListener(a)},FloatingTextField.prototype.getText=function(){return this.fEditWidget.getText()},FloatingTextField.prototype.getPreferredSize=function(a){return this.fEditWidget.getPreferredSize(a)},Geom.prototype.initGeom=function(){},Geom.prototype.lineContainsPoint=function(a,b,c,d,e,f){var g=new gRectangle(new Point(a,b));if(g.add(c,d),g.grow(2,2),!g.contains(e,f))return!1;var h,i,j,k;return a==c?Math.abs(e-a)<3:b==d?Math.abs(f-b)<3:(h=(b-d)/(a-c),i=b-h*a,j=(f-i)/h,k=h*e+i,Math.min(Math.abs(j-e),Math.abs(k-f))<4)},Geom.prototype.direction=function(a,b,c,d){var e=0,f=c-a,g=d-b;return e=f>g&&f>-g?EAST:g>f&&g>-f?NORTH:g>f&&-g>f?WEST:SOUTH},Geom.prototype.south=function(a){return new Point(a.x+a.width/2,a.y+a.height)},Geom.prototype.center=function(a){return new Point(a.x+a.width/2,a.y+a.height/2)},Geom.prototype.west=function(a){return new Point(a.x,a.y+a.height/2)},Geom.prototype.east=function(a){return new Point(a.x+a.width,a.y+a.height/2)},Geom.prototype.north=function(a){return new Point(a.x+a.width/2,a.y)},Geom.prototype.range=function(a,b,c){return a>c&&(c=a),c>b&&(c=b),c},Geom.prototype.length2=function(a,b,c,d){return(c-a)*(c-a)+(d-b)*(d-b)},Geom.prototype.length=function(a,b,c,d){return Math.sqrt(this.length2(a,b,c,d))},Geom.prototype.pointToAngle=function(a,b){var c=b.x-(a.x+a.width/2),d=b.y-(a.y+a.height/2);return Math.atan2(d*a.width,c*a.height)},Geom.prototype.angleToPoint=function(a,b){},Geom.prototype.polarToPoint=function(a,b,c){var d=Math.sin(a),e=Math.cos(a);return new Point(parseInt(b*e+.5),parseInt(c*d+.5))},Geom.prototype.ovalAngleToPoint=function(a,b){var c=this.center(a),d=this.polarToPoint(b,a.width/2,a.height/2);return new Point(c.x+d.x,c.y+d.y)},Geom.prototype.intersect=function(a,b,c,d,e,f,g,h){var i=(c-a)*(h-f)-(d-b)*(g-e),j=(b-f)*(g-e)-(a-e)*(h-f);if(0==i)return 0==j?c>a&&(e>c||g>c)||a>c&&(c>e||c>g)?new Point(c,d):new Point(a,b):null;var k=j/i,l=(b-f)*(c-a)-(a-e)*(d-b),m=l/i;if(k>=0&&1>=k&&m>=0&&1>=m){var n=parseInt(a+(c-a)*k),o=parseInt(b+(d-b)*k);return new Point(n,o)}return null};var geom=new Geom;FigureTransferCommand.prototype=new Command,FigureTransferCommand.prototype.initFigureTransferCommand=function(a,b){this.initCommand(a),this.fView=b},FigureTransferCommand.prototype.deleteSelection=function(){this.fView.removeAll(this.fView.selection()),this.fView.clearSelection(),this.fView.drawAll()},FigureTransferCommand.prototype.copySelection=function(){this.fView.getFigureSelection()},FigureTransferCommand.prototype.insertFigures=function(a,b,c){for(var d=new FigureEnumerator(a);d.hasMoreElements();){var e=d.nextFigure();e.moveBy(b,c),e=this.fView.add(e),this.fView.addToSelection(e)}},DeleteCommand.prototype=new FigureTransferCommand,DeleteCommand.prototype.initDeleteCommand=function(a,b){this.initFigureTransferCommand(a,b)},DeleteCommand.prototype.execute=function(){this.deleteSelection()},DeleteCommand.prototype.isExecutable=function(){return this.fView.selectionCount()>0},DuplicateCommand.prototype=new FigureTransferCommand,DuplicateCommand.prototype.initDuplicateCommand=function(a,b){this.initFigureTransferCommand(a,b)},DuplicateCommand.prototype.execute=function(){alert("Not Implemented")},DuplicateCommand.prototype.isExecutable=function(){return this.fView.selectionCount()>0},GroupCommand.prototype=new FigureTransferCommand,GroupCommand.prototype.initGroupCommand=function(a,b){this.initFigureTransferCommand(a,b)},GroupCommand.prototype.execute=function(){var a=this.fView.selectionZOrdered(),b=this.fView.drawing();if(a.size()>0){this.fView.clearSelection(),b.orphanAll(a);var c=new GroupFigure;c.addAll(a),this.fView.addToSelection(b.add(c))}},GroupCommand.prototype.isExecutable=function(){return this.fView.selectionCount()>0},UngroupCommand.prototype=new FigureTransferCommand,UngroupCommand.prototype.initUngroupCommand=function(a,b){this.initFigureTransferCommand(a,b)},UngroupCommand.prototype.execute=function(){var a=this.fView.selectionElements();for(this.fView.clearSelection();a.hasMoreElements();)for(var b=a.nextFigure(),c=this.fView.drawing().orphan(b),d=c.decompose();d.hasMoreElements();){var e=d.nextFigure();this.fView.addToSelection(this.fView.add(e))}},UngroupCommand.prototype.isExecutable=function(){return this.fView.selectionCount()>0},FigureEnumerator.prototype=new FigureEnumeration,FigureEnumerator.prototype.initFigureEnumerator=function(a){this.fEnumeration=a.elements()},FigureEnumerator.prototype.hasMoreElements=function(){return this.fEnumeration.hasMoreElements()},FigureEnumerator.prototype.nextElement=function(){return this.fEnumeration.nextElement()},FigureEnumerator.prototype.nextFigure=function(){return this.fEnumeration.nextElement()},ReverseFigureEnumerator.prototype=new FigureEnumeration,ReverseFigureEnumerator.prototype.initReverseFigureEnumerator=function(a){this.fEnumeration=new ReverseVectorEnumerator(a)},ReverseFigureEnumerator.prototype.hasMoreElements=function(){return this.fEnumeration.hasMoreElements()},ReverseFigureEnumerator.prototype.nextElement=function(){return this.fEnumeration.nextElement()},ReverseFigureEnumerator.prototype.nextFigure=function(){return this.fEnumeration.nextElement()},FigureChangeEventMulticaster.prototype.initFigureChangeEventMulticaster=function(a,b){this.a=a,this.b=b},FigureChangeEventMulticaster.prototype.figureInvalidated=function(a){this.a.figureInvalidated(a),this.b.figureInvalidated(a)},FigureChangeEventMulticaster.prototype.figureRequestRemove=function(a){this.a.figureRequestRemove(a),this.b.figureRequestRemove(a)},FigureChangeEventMulticaster.prototype.figureRequestUpdate=function(a){this.a.figureRequestUpdate(a),this.b.figureRequestUpdate(a)},FigureChangeEventMulticaster.prototype.figureChanged=function(a){this.a.figureChanged(a),this.b.figureChanged(a)},FigureChangeEventMulticaster.prototype.figureRemoved=function(a){this.a.figureRemoved(a),this.b.figureRemoved(a)},FigureChangeEventMulticaster.prototype.add=function(a,b){return this.addInternal(a,b)},FigureChangeEventMulticaster.prototype.addInternal=function(a,b){return null==a?b:null==b?a:new FigureChangeEventMulticaster(a,b)},FigureChangeEventMulticaster.prototype.remove=function(c,d){if(c instanceof EventListener&&!d){if(d=c,d==this.a)return this.b;if(d==this.b)return this.a;var e=this.removeInternal(a,d),f=this.removeInternal(b,d);return e==this.a&&f==this.b?this:this.addInternal(e,f)}return this.removeInternal(c,d)},FigureChangeEventMulticaster.prototype.removeInternal=function(a,b){return a==b||null==a?null:a instanceof FigureChangeEventMulticaster?a.remove(b):a};var figureChangeEventMulticaster=new FigureChangeEventMulticaster;AbstractFigure.prototype.initAbstractFigure=function(){this.obtainFigureId()},AbstractFigure.prototype.getId=function(){return this.id},AbstractFigure.prototype.setId=function(a){this.id=a},AbstractFigure.prototype.obtainFigureId=function(){var a=this.className;return null==this.id&&(void 0==this.counter[a]?this.counter[a]=0:this.counter[a]++,this.myCount=this.counter[a],this.id=this.className+"_"+this.myCount),this.id},AbstractFigure.prototype.moveBy=function(a,b){this.basicMoveBy(a,b),this.changed()},AbstractFigure.prototype.getShape=function(){return this.shape},AbstractFigure.prototype.isCreated=function(){return this.created&&null!=this.shape},AbstractFigure.prototype.createSVGContent=function(a){},AbstractFigure.prototype.draw=function(a){this.drawAbstractFigure(a)},AbstractFigure.prototype.drawAbstractFigure=function(a){this.created||(this.created=!0,this.createSVGContent(a)),void 0!=a&&a.addChild(this.shape.getNode())},AbstractFigure.prototype.basicMoveBy=function(a,b){},AbstractFigure.prototype.displayBox=function(a,b){if(void 0==a&&void 0==b)return this.ret_displayBox();if(a instanceof gRectangle){var c=a;return void this.displayBox(new Point(c.x,c.y),new Point(c.x+c.width,c.y+c.height))}this.willChange(),this.basicDisplayBox(a,b),this.changed()},AbstractFigure.prototype.basicDisplayBox=function(a,b){},AbstractFigure.prototype.ret_displayBox=function(){},AbstractFigure.prototype.handles=function(){},AbstractFigure.prototype.figures=function(){var a=new Vector;return a.addElement(this),new FigureEnumerator(a)},AbstractFigure.prototype.size=function(){return new Dimension(this.displayBox().width,this.displayBox().height)},AbstractFigure.prototype.isEmpty=function(){return this.size().width<3||this.size().height<3},AbstractFigure.prototype.findFigureInside=function(a,b){return this.containsPoint(a,b)?this:null},AbstractFigure.prototype.containsPoint=function(a,b){return this.displayBox().contains(a,b)},AbstractFigure.prototype.includes=function(a){return a==this},AbstractFigure.prototype.decompose=function(){return figures=new Vector,figures.addElement(this),new FigureEnumerator(figures)},AbstractFigure.prototype.addToContainer=function(a){this.addFigureChangeListener(a),this.invalidate()},AbstractFigure.prototype.removeFromContainer=function(a){this.removeFigureChangeListener(a),this.changed()},AbstractFigure.prototype.addFigureChangeListener=function(a){this.fListener=figureChangeEventMulticaster.add(this.fListener,a)},AbstractFigure.prototype.removeFigureChangeListener=function(a){this.fListener=figureChangeEventMulticaster.remove(this.fListener,a)},AbstractFigure.prototype.listener=function(){return this.fListener},AbstractFigure.prototype.release=function(){this.abstractFigureRelease()},AbstractFigure.prototype.abstractFigureRelease=function(){null!=this.fListener&&this.fListener.figureRemoved(new FigureChangeEvent(this)),this.dispose()},AbstractFigure.prototype.dispose=function(){this.disposeAbstractFigure()},AbstractFigure.prototype.disposeAbstractFigure=function(){null!=this.shape&&this.shape.dispose(),this.shape=null},AbstractFigure.prototype.invalidate=function(){},AbstractFigure.prototype.willChange=function(){},AbstractFigure.prototype.changed=function(){this.changedAbstractFigure()},AbstractFigure.prototype.changedAbstractFigure=function(){null!=this.fListener&&this.fListener.figureChanged(new FigureChangeEvent(this))},AbstractFigure.prototype.center=function(){},AbstractFigure.prototype.canConnect=function(){return!0},AbstractFigure.prototype.connectionInsets=function(){return new Insets(0,0,0,0)},AbstractFigure.prototype.connectorAt=function(a,b){},AbstractFigure.prototype.connectorVisibility=function(a){},AbstractFigure.prototype.connectedTextLocator=function(a){},AbstractFigure.prototype.getAttribute=function(a){return null},AbstractFigure.prototype.setAttribute=function(a,b){},AbstractFigure.prototype.clone=function(){return new cloneObject(this)},AbstractFigure.prototype.write=function(a){},AbstractFigure.prototype.read=function(){},AbstractFigure.prototype.serialize=function(){return this.serializeAbstractFigure()},AbstractFigure.prototype.serializeAbstractFigure=function(){var a=this.displayBox(),b=new Hashtable,c=this.id;return b.put("class",this.className),b.put("id",c),b.put("x",a.getX()),b.put("y",a.getY()),b.put("w",a.getWidth()),b.put("h",a.getHeight()),b.serialize()},AbstractFigure.prototype.deserialize=function(a){return this.deserializeAbstractFigure(a)},AbstractFigure.prototype.deserializeAbstractFigure=function(a){var b=new Hashtable;b.deserialize(a);var c=b.get("id");this.setId(c);var d=parseFloat(b.get("x")),e=parseFloat(b.get("y")),f=parseFloat(b.get("w")),g=parseFloat(b.get("h"));return this.displayBox(new Point(d,e),new Point(d+f,e+g)),b},AbstractFigure.prototype.serializeAsRDF=function(a,b){return this.serializeAsRDFAbstractFigure(a,b)},AbstractFigure.prototype.serializeAsRDFAbstractFigure=function(a,b){var c="",d=this.displayBox(),e=this.shape.getNode().nodeName,f="<"+a+e+"_"+this.myCount+">",g="<"+a+e+"_"+this.myCount+"/historyNode_"+this.historyNodeCounter+"> ",h=this.getAuthor(),i=this.id,j=this.date.toISO8601String(6);return 0==this.historyNodeCounter?(c=f+" rdf:type svg:"+e+" . ",c+=f+" svgcwe:owned-by <"+a+"> . ",c+=g+' dc:Creator "'+h+'". '):c+=g+' dc:Contributor "'+h+'". ',c+=g+' dc:Date "'+j+'". ',c+=g+" rdf:type svgcwe:HistoryNode . ",c+=g+" svgcwe:owned-by "+f+" . ",c+=g+' svgcwe:command "'+b+'" . ',c+=g+' svg:id "'+i+'" . ',c+=g+" svg:x "+d.getX()+" . ",c+=g+" svg:y "+d.getY()+" . ",c+=g+" svg:width "+d.getWidth()+". ",c+=g+" svg:height "+d.getHeight()+" . ",this.historyNodeCounter++,c},AbstractFigure.prototype.toString=function(){return this.className};var common_composite_figure_id="composite_figure_id_",cocomposite_figure_counter=0;CompositeFigure.prototype=new AbstractFigure,CompositeFigure.prototype.initCompositeFigure=function(){this.fFigures=new Vector(100),this.g=new Graphics(0,0,0,0,getCompositeFigureId())},CompositeFigure.prototype.add=function(a){return this.fFigures.contains(a)||(this.fFigures.addElement(a),a.addToContainer(this)),a},CompositeFigure.prototype.addAll=function(a){for(var b=a.elements();b.hasMoreElements();)this.add(b.nextElement())},CompositeFigure.prototype.remove=function(a){this.removeCompositeFigure(a)},CompositeFigure.prototype.removeCompositeFigure=function(a){return this.fFigures.contains(a)&&(a.removeFromContainer(this),a.dispose(),this.fFigures.removeElement(a)),a},CompositeFigure.prototype.removeAll=function(a){this.removeAllCompositeFigure(a)},CompositeFigure.prototype.removeAllCompositeFigure=function(a){if(void 0==a){for(var b=this.figures();b.hasMoreElements();)this.remove(b.nextFigure());return void this.fFigures.removeAllElements()}for(var b=a.elements();b.hasMoreElements();)this.remove(b.nextElement())},CompositeFigure.prototype.orphan=function(a){return this.fFigures.removeElement(a),a},CompositeFigure.prototype.orphanAll=function(a){for(var b=a.elements();b.hasMoreElements();)this.orphan(b.nextElement())},CompositeFigure.prototype.replace=function(a,b){var c=this.fFigures.indexOf(a);-1!=c&&(b.addToContainer(this),a.changed(),this.fFigures.setElementAt(b,c))},CompositeFigure.prototype.sendToBack=function(a){1!=this.fFigures.size()&&this.fFigures.contains(a)&&(this.fFigures.removeElement(a),this.fFigures.insertElementAt(a,0),a.changed())},CompositeFigure.prototype.bringToFront=function(a){this.fFigures.contains(a)&&(this.fFigures.removeElement(a),this.fFigures.addElement(a),a.changed())},CompositeFigure.prototype.draw=function(a){null!=this.g&&this.g.clear();for(var b=this.figures();b.hasMoreElements();){var c=b.nextFigure();c.draw(this.g)}void 0!=a&&a.addGraphics(this.g)},CompositeFigure.prototype.figureAt=function(a){return this.fFigures.elementAt(a)},CompositeFigure.prototype.figures=function(){return new FigureEnumerator(this.fFigures)},CompositeFigure.prototype.figureCount=function(){return this.fFigures.size()},CompositeFigure.prototype.figuresReverse=function(){return new ReverseFigureEnumerator(this.fFigures)},CompositeFigure.prototype.findFigure=function(a,b){var c=this.figuresReverse();if(a instanceof gRectangle){for(var d=a;c.hasMoreElements();){var e=c.nextFigure(),f=e.displayBox();if(d.intersects(f))return e}return null}for(;c.hasMoreElements();){var e=c.nextFigure();if(e.containsPoint(a,b))return e}return null},CompositeFigure.prototype.findFigureWithout=function(a,b,c){var d=this.figuresReverse();if(a instanceof gRectangle){var e=a;if(c=b,null==c)return this.findFigure(e);for(;d.hasMoreElements();){var f=d.nextFigure(),g=f.displayBox();if(e.intersects(g)&&!f.includes(c))return f}return null}if(null==c)return this.findFigure(a,b);for(;d.hasMoreElements();){var f=d.nextFigure();if(f.containsPoint(a,b)&&!f.includes(c))return f}return null},CompositeFigure.prototype.findFigureInside=function(a,b){for(var c=this.figuresReverse();c.hasMoreElements();){var d=c.nextFigure().findFigureInside(a,b);if(null!=d)return d}return null},CompositeFigure.prototype.findFigureInsideWithout=function(a,b,c){for(var d=this.figuresReverse();d.hasMoreElements();){var e=d.nextFigure();if(e!=c){var f=e.findFigureInside(a,b);if(null!=f)return f}}return null},CompositeFigure.prototype.includes=function(a){for(var b=this.figures();b.hasMoreElements();){var c=b.nextFigure();if(c.includes(a))return!0}return!1},CompositeFigure.prototype.basicMoveBy=function(a,b){for(var c=this.figures();c.hasMoreElements();)c.nextFigure().moveBy(a,b)},CompositeFigure.prototype.release=function(){this.abstractFigureRelease();for(var a=this.figures();a.hasMoreElements();){var b=a.nextFigure();b.release()}},CompositeFigure.prototype.figureInvalidated=function(a){null!=this.listener()&&this.listener().figureInvalidated(a)},CompositeFigure.prototype.figureRequestRemove=function(a){null!=this.listener()&&this.listener().figureRequestRemove(new FigureChangeEvent(this))},CompositeFigure.prototype.figureRequestUpdate=function(a){null!=this.listener()&&this.listener().figureRequestUpdate(a)},CompositeFigure.prototype.figureChanged=function(a){},CompositeFigure.prototype.figureRemoved=function(a){},CompositeFigure.prototype.write=function(a){},CompositeFigure.prototype.read=function(a){},StandardDrawing.prototype=new CompositeFigure,StandardDrawing.prototype.initStandardDrawing=function(){this.initCompositeFigure(),this.fListeners=new Vector(2)},StandardDrawing.prototype.addDrawingChangeListener=function(a){this.fListeners.addElement(a)},StandardDrawing.prototype.removeDrawingChangeListener=function(a){this.fListeners.removeElement(a)},StandardDrawing.prototype.drawingChangeListeners=function(){return this.fListeners.elements()},StandardDrawing.prototype.remove=function(a){return null!=a.listener()?(a.listener().figureRequestRemove(new FigureChangeEvent(a,null)),a):null},StandardDrawing.prototype.figureRequestRemove=function(a){var b=a.getFigure();this.fFigures.contains(b)&&(this.fFigures.removeElement(b),b.removeFromContainer(this),b.release())},StandardDrawing.prototype.figureInvalidated=function(a){if(null!=this.fListeners)for(var b=0;b<this.fListeners.size();b++){var c=this.fListeners.elementAt(b);c.drawingInvalidated(new DrawingChangeEvent(this,a.getInvalidatedRectangle()))}},StandardDrawing.prototype.figureRequestUpdate=function(a){if(null!=this.fListeners)for(var b=0;b<this.fListeners.size();b++){var c=this.fListeners.elementAt(b);c.drawingRequestUpdate(new DrawingChangeEvent(this,null))}},StandardDrawing.prototype.handles=function(){},StandardDrawing.prototype.displayBox=function(){if(this.fFigures.size()>0){for(var a=this.figures(),b=a.nextFigure().displayBox();a.hasMoreElements();)b.add(a.nextFigure().displayBox());return b}return new gRectangle(0,0,0,0)},StandardDrawing.prototype.basicDisplayBox=function(a,b){},StandardDrawing.prototype.lock=function(){},StandardDrawing.prototype.unlock=function(){},StandardDrawing.prototype.readObject=function(a){},AbstractTool.prototype.initAbstractTool=function(a){this.fView=a},AbstractTool.prototype.activate=function(){this.activateAbstractTool()},AbstractTool.prototype.activateAbstractTool=function(){this.fView.clearSelection()},AbstractTool.prototype.deactivate=function(){this.deactivateAbstractTool()},AbstractTool.prototype.deactivateAbstractTool=function(){this.view().setCursor("default")},AbstractTool.prototype.mouseDown=function(a,b,c){this.fAnchorX=b,this.fAnchorY=c},AbstractTool.prototype.mouseDrag=function(a,b,c){},AbstractTool.prototype.mouseUp=function(a,b,c){},AbstractTool.prototype.mouseMove=function(a,b,c){},AbstractTool.prototype.keyDown=function(a,b,c){},AbstractTool.prototype.drawing=function(){return this.fView.drawing()},AbstractTool.prototype.editor=function(){return this.fView.editor()},AbstractTool.prototype.view=function(){return this.fView},AbstractTool.prototype.toString=function(){return this.className},AbstractTool.prototype.fireViewEvent=function(a,b){void 0!=this.fView.changed&&this.fView.changed(a,b)},SelectionTool.prototype=new AbstractTool,SelectionTool.prototype.initSelectionTool=function(a){this.initAbstractTool(a)},SelectionTool.prototype.mouseDown=function(a,b,c){if(null==this.fChild){var d=this.view().findHandle(a.getX(),a.getY());if(null!=d)this.fChild=this.createHandleTracker(this.view(),d);else{var e=this.drawing().findFigure(a.getX(),a.getY());null!=e?this.fChild=this.createDragTracker(this.view(),e):(a.isShiftDown()||this.view().clearSelection(),this.fChild=this.createAreaTracker(this.view()))}this.fChild.mouseDown(a,b,c)}},SelectionTool.prototype.mouseMove=function(a,b,c){var d=this.view().findHandle(b,c);this.view().setCursor(null!=d?d.getCursorName():"default")},SelectionTool.prototype.mouseDrag=function(a,b,c){null!=this.fChild&&this.fChild.mouseDrag(a,b,c)},SelectionTool.prototype.mouseUp=function(a,b,c){null!=this.fChild&&this.fChild.mouseUp(a,b,c),this.fChild=null},SelectionTool.prototype.createHandleTracker=function(a,b){return new HandleTracker(a,b)},SelectionTool.prototype.createDragTracker=function(a,b){return new DragTracker(a,b)},SelectionTool.prototype.createAreaTracker=function(a){return new SelectAreaTracker(a)},StandardDrawingView.prototype=new Panel,StandardDrawingView.prototype.initStandardDrawingView=function(a,b,c){this.initPanel(0,0,b,c),this.fEditor=a,this.fViewSize=new Dimension(b,c),this.fLastClick=new Point(0,0),this.fConstrainer=null,this.fSelection=new Vector,this.addMouseListener(this),this.addMouseMotionListener(this),this.addKeyListener(this),ds_addEventListener(this,"click","desktopMouseClick"),ds_addEventListener(this,"mousedown","desktopMouseClick")},StandardDrawingView.prototype.desktopMouseClick=function(a){this.lostFocus()},StandardDrawingView.prototype.paint=function(a){this.paintStandardDrawingView(a)},StandardDrawingView.prototype.paintStandardDrawingView=function(a){this.paintPanel(a),this.lostFocus()},StandardDrawingView.prototype.createSVGContent=function(){this.createSVGContentStandardDrawingView()},StandardDrawingView.prototype.createSVGContentStandardDrawingView=function(){this.createSVGContentPanel(),this.viewcontentg=this.getGraphics(),this.selectiong=this.getGraphics(),this.textBoxg=this.getGraphics(),this.glassPaneOn(),this.enableMouseListener(),this.enableMouseMotionListener(),this.enableKeyListener()},StandardDrawingView.prototype.recalc=function(){this.recalcStandardDrawingView()},StandardDrawingView.prototype.recalcStandardDrawingView=function(){this.recalcPanel()},StandardDrawingView.prototype.setEditor=function(a){this.fEditor=a},StandardDrawingView.prototype.setDrawing=function(a){this.clearSelection(),null!=this.fDrawing&&this.fDrawing.removeDrawingChangeListener(this),this.fDrawing=a,null!=this.fDrawing&&this.fDrawing.addDrawingChangeListener(this),this.checkMinimumSize(),this.repaint()},StandardDrawingView.prototype.tool=function(){return this.fEditor.tool()},StandardDrawingView.prototype.drawing=function(){return this.fDrawing},StandardDrawingView.prototype.editor=function(){return this.fEditor},StandardDrawingView.prototype.standardDrawingViewAdd=function(a){return this.drawing().add(a)},StandardDrawingView.prototype.add=function(a){return a instanceof Component?this.addContainer(a):this.standardDrawingViewAdd(a)},StandardDrawingView.prototype.remove=function(a){return a instanceof Component?this.removeContainer(a):this.standardDrawingViewRemove(a)},StandardDrawingView.prototype.standardDrawingViewRemove=function(a){return this.drawing().remove(a)},StandardDrawingView.prototype.addAll=function(a){for(var b=new FigureEnumerator(a);b.hasMoreElements();)this.add(b.nextFigure())},StandardDrawingView.prototype.removeAll=function(a){if(void 0==a){for(var b=this.drawing().figures();b.hasMoreElements();){var c=b.nextFigure();this.remove(c)}return void this.clearSelection()}for(var b=a.elements();b.hasMoreElements();){var c=b.nextElement();this.remove(c)}this.clearSelection()},StandardDrawingView.prototype.getMinimumSize=function(){return this.fViewSize},StandardDrawingView.prototype.getPreferredSize=function(){return this.getMinimumSize()},StandardDrawingView.prototype.setDisplayUpdate=function(a){this.fUpdateStrategy=a},StandardDrawingView.prototype.selection=function(){return this.fSelection},StandardDrawingView.prototype.selectionElements=function(){return new FigureEnumerator(this.fSelection)},StandardDrawingView.prototype.selectionZOrdered=function(){for(var a=new Vector(this.fSelection.size()),b=this.drawing().figures();b.hasMoreElements();){var c=b.nextFigure();this.fSelection.contains(c)&&a.addElement(c)}return a},StandardDrawingView.prototype.selectionCount=function(){return this.fSelection.size()},StandardDrawingView.prototype.addToSelection=function(a){this.fSelection.contains(a)||(this.fSelection.addElement(a),this.fSelectionHandles=null,a.invalidate(),this.selectionChanged())},StandardDrawingView.prototype.addToSelectionAll=function(a){for(var b=new FigureEnumerator(figures);b.hasMoreElements();)this.addToSelection(b.nextFigure())},StandardDrawingView.prototype.removeFromSelection=function(a){this.fSelection.contains(a)&&(this.fSelection.removeElement(a),this.fSelectionHandles=null,a.invalidate(),this.selectionChanged())},StandardDrawingView.prototype.toggleSelection=function(a){this.disposeSvgHandles(),this.fSelection.contains(a)?this.removeFromSelection(a):this.addToSelection(a),this.selectionChanged()},StandardDrawingView.prototype.clearSelection=function(){for(k=this.selectionElements();k.hasMoreElements();)k.nextFigure().invalidate();this.fSelection=new Vector,this.disposeSvgHandles(),this.selectionChanged()},StandardDrawingView.prototype.disposeSvgHandles=function(){for(var a=this.selectionHandles();a.hasMoreElements();)a.nextElement().dispose();

this.fSelectionHandles.clear(),this.fSelectionHandles=null},StandardDrawingView.prototype.selectionHandles=function(){if(null==this.fSelectionHandles){this.fSelectionHandles=new Vector;for(var a=this.selectionElements();a.hasMoreElements();)for(var b=a.nextFigure(),c=b.handles().elements();c.hasMoreElements();)this.fSelectionHandles.addElement(c.nextElement())}return this.fSelectionHandles.elements()},StandardDrawingView.prototype.getFigureSelection=function(){return new FigureSelection(this.selectionZOrdered())},StandardDrawingView.prototype.findHandle=function(a,b){for(var c,d=this.selectionHandles();d.hasMoreElements();)if(c=d.nextElement(),c.containsPoint(a,b))return c;return null},StandardDrawingView.prototype.selectionChanged=function(){this.fEditor.selectionChanged(this)},StandardDrawingView.prototype.lastClick=function(){return this.fLastClick},StandardDrawingView.prototype.setConstrainer=function(a){this.fConstrainer=a},StandardDrawingView.prototype.getConstrainer=function(){return this.fConstrainer},StandardDrawingView.prototype.constrainPoint=function(a){this.getSize();return null!=this.fConstrainer?this.fConstrainer.constrainPoint(a):a},StandardDrawingView.prototype.mouseStartDragged=function(a){this.mouseStartDraggedStandardDrawingView(a)},StandardDrawingView.prototype.mouseStartDraggedStandardDrawingView=function(a){this.hideShowHandles(!1)},StandardDrawingView.prototype.mouseEndDragged=function(a){this.hideShowHandles(!0),this.mouseReleased(a,p.x,p.y)},StandardDrawingView.prototype.mouseDragged=function(a){this.mouseDraggedStandardDrawingView(a)},StandardDrawingView.prototype.mouseDraggedStandardDrawingView=function(a){this.tool().mouseDrag(a,a.x,a.y)},StandardDrawingView.prototype.mouseMoved=function(a){this.tool().mouseMove(a,a.x,a.y)},StandardDrawingView.prototype.mousePressed=function(a){this.mousePressedStandardDrawingView(a)},StandardDrawingView.prototype.mousePressedStandardDrawingView=function(a){this.gainFocus(),p=this.constrainPoint(new Point(a.getX(),a.getY())),this.fLastClick=new Point(a.getX(),a.getY()),this.tool().mouseDown(a,p.x,p.y),this.checkDamage(),this.drawAll()},StandardDrawingView.prototype.mouseReleased=function(a){var b=this.constrainPoint(new Point(a.getX(),a.getY()));this.tool().mouseUp(a,b.x,b.y),this.checkDamage(),this.drawAll()},StandardDrawingView.prototype.keyTyped=function(a){a.getKeyChar()},StandardDrawingView.prototype.keyReleased=function(a){},StandardDrawingView.prototype.keyPressed=function(a){var b=a.getKeyCode();if(b==VK_BACK_SPACE||b==VK_DELETE){var c=new DeleteCommand("Delete",this);c.execute()}else b==VK_DOWN||b==VK_UP||b==VK_RIGHT||b==VK_LEFT?this.handleCursorKey(b):b==VK_PAGE_UP?this.sendSelectionToFront():b==VK_PAGE_DOWN?this.sendSelectionToBack():this.tool().keyDown(a,b);this.checkDamage()},StandardDrawingView.prototype.handleCursorKey=function(a){var b=0,c=0,d=1,e=1;switch(null!=this.fConstrainer&&(d=this.fConstrainer.getStepX(),e=this.fConstrainer.getStepY()),a){case VK_DOWN:c=e;break;case VK_UP:c=-e;break;case VK_RIGHT:b=d;break;case VK_LEFT:b=-d}this.moveSelection(b,c)},StandardDrawingView.prototype.moveSelection=function(a,b){for(var c=this.selectionElements();c.hasMoreElements();){var d=c.nextFigure();d.moveBy(a,b)}this.drawAll(),this.checkDamage()},StandardDrawingView.prototype.sendSelectionToFront=function(){var a=this.drawing();for(k=this.selectionElements();k.hasMoreElements();){var b=k.nextFigure();a.bringToFront(b),void 0!=this.changed&&this.changed(b,"OrderFront")}this.drawAll()},StandardDrawingView.prototype.sendSelectionToBack=function(){var a=this.drawing();for(k=this.selectionElements();k.hasMoreElements();){var b=k.nextFigure();a.sendToBack(b),void 0!=this.changed&&this.changed(b,"OrderBack")}this.drawAll()},StandardDrawingView.prototype.checkDamage=function(){},StandardDrawingView.prototype.drawAll=function(a){void 0==a&&(a=this.viewcontentg);var b=!1;this.drawBackground(a),null==this.fBackgrounds||b||this.drawPainters(a,this.fBackgrounds),this.drawDrawing(a),null==this.fForegrounds||b||this.drawPainters(a,this.fForegrounds),b||this.drawHandles(a)},StandardDrawingView.prototype.drawHandles=function(a){void 0==a&&(a=this.viewcontentg);for(var b=this.selectionHandles();b.hasMoreElements();)b.nextElement().draw(a)},StandardDrawingView.prototype.hideShowHandles=function(a){for(var b=this.selectionHandles();b.hasMoreElements();)b.nextElement().getShape().setVisibility(a)},StandardDrawingView.prototype.drawDrawing=function(a){void 0==a&&(a=this.viewcontentg),this.fDrawing.draw(a)},StandardDrawingView.prototype.drawBackground=function(a){},StandardDrawingView.prototype.drawPainters=function(a,b){for(var c=0;c<b.size();c++)b.elementAt(c).draw(a,this)},StandardDrawingView.prototype.addBackground=function(a){null==this.fBackgrounds&&(this.fBackgrounds=new Vector(3)),this.fBackgrounds.addElement(a),this.repaint()},StandardDrawingView.prototype.removeBackground=function(a){null!=this.fBackgrounds&&this.fBackgrounds.removeElement(a),this.repaint()},StandardDrawingView.prototype.removeForeground=function(a){null!=this.fForegrounds&&this.fForegrounds.removeElement(a),this.repaint()},StandardDrawingView.prototype.addForeground=function(a){null==this.fForegrounds&&(this.fForegrounds=new Vector(3)),this.fForegrounds.addElement(a),this.repaint()},StandardDrawingView.prototype.checkMinimumSize=function(){for(var a=this.drawing().figures(),b=new Dimension(0,0);a.hasMoreElements();){var c=a.nextFigure().displayBox();b.width=Math.max(b.width,c.x+c.width),b.height=Math.max(b.height,c.y+c.height)}(this.fViewSize.height<b.height||this.fViewSize.width<b.width)&&(this.fViewSize.height=b.height+10,this.fViewSize.width=b.width+10,this.setSize(this.fViewSize))},StandardDrawingView.prototype.isFocusTraversable=function(){return!0},StandardDrawingView.prototype.mouseEntered=function(a){},StandardDrawingView.prototype.mouseExited=function(a){},StandardDrawingView.prototype.mouseClicked=function(a){this.gainFocus()},StandardDrawingView.prototype.toString=function(){return this.className},StandardDrawingView.prototype.freezeView=function(){this.drawing().lock()},StandardDrawingView.prototype.unfreezeView=function(){this.drawing().unlock()},StandardDrawingView.prototype.readObject=function(a){},StandardDrawingView.prototype.repairDamage=function(){},StandardDrawingView.prototype.drawingInvalidated=function(a){},StandardDrawingView.prototype.drawingRequestUpdate=function(a){this.repairDamage()},StandardDrawingView.prototype.update=function(a){this.paint(a)},StandardDrawingView.prototype.checkDamage=function(){},ToolButton.prototype=new PaletteButton,ToolButton.prototype.initToolButton=function(a,b,c,d){this.initPaletteButton(a),this.fTool=d,this.fName=c,this.fIconName=b,this.created=!1},ToolButton.prototype.createSVGContent=function(){this.createSVGContentToolButton()},ToolButton.prototype.createSVGContentToolButton=function(){this.createSVGContentPaletteButton();var a=24,b=24;this.contentg=this.getGraphics();var c=this.contentg.drawImage(0,0,a,b,this.fIconName+"1.gif"),d=this.contentg.drawImage(0,0,a,b,this.fIconName+"2.gif"),e=this.contentg.drawImage(0,0,a,b,this.fIconName+"3.gif");c.setVisibility(!0),d.setVisibility(!1),e.setVisibility(!1),this.fIcon=new PaletteIcon(new Dimension(a,b),c,d,e)},ToolButton.prototype.tool=function(){return this.fTool},ToolButton.prototype.name=function(){return this.fName},ToolButton.prototype.attributeValue=function(){return this.tool()},ToolButton.prototype.getMinimumSize=function(){return new Dimension(this.fIcon.getWidth(),this.fIcon.getHeight())},ToolButton.prototype.getPreferredSize=function(){return new Dimension(this.fIcon.getWidth(),this.fIcon.getHeight())},ToolButton.prototype.paintBackground=function(a){},ToolButton.prototype.paintNormal=function(a){this.fIcon.normal().setVisibility(!0),this.fIcon.pressed().setVisibility(!1),this.fIcon.selected().setVisibility(!1)},ToolButton.prototype.paintPressed=function(a){this.fIcon.normal().setVisibility(!1),this.fIcon.pressed().setVisibility(!0),this.fIcon.selected().setVisibility(!1)},ToolButton.prototype.paintSelected=function(a){this.fIcon.selected().setVisibility(!0),this.fIcon.normal().setVisibility(!1),this.fIcon.pressed().setVisibility(!1)},PaletteIcon.prototype.initPaletteIcon=function(a,b,c,d){this.fSize=a,this.fNormal=b,this.fPressed=c,this.fSelected=d},PaletteIcon.prototype.normal=function(){return this.fNormal},PaletteIcon.prototype.pressed=function(){return this.fPressed},PaletteIcon.prototype.selected=function(){return this.fSelected},PaletteIcon.prototype.getWidth=function(){return this.fSize.width},PaletteIcon.prototype.getHeight=function(){return this.fSize.height},SelectAreaTracker.prototype=new AbstractTool,SelectAreaTracker.prototype.initSelectAreaTracker=function(a){this.initAbstractTool(a)},SelectAreaTracker.prototype.mouseDown=function(a,b,c){this.fAnchorX=a.getX(),this.fAnchorY=a.getY(),this.rubberBand(this.fAnchorX,this.fAnchorY,this.fAnchorX,this.fAnchorY)},SelectAreaTracker.prototype.mouseDrag=function(a,b,c){this.rubberBand(this.fAnchorX,this.fAnchorY,b,c)},SelectAreaTracker.prototype.mouseUp=function(a,b,c){this.eraseRubberBand(),this.selectGroup(a.isShiftDown())},SelectAreaTracker.prototype.rubberBand=function(a,b,c,d){this.fSelectGroup=new gRectangle(new Point(a,b)),this.fSelectGroup.add(new Point(c,d)),this.drawXORRect(this.fSelectGroup)},SelectAreaTracker.prototype.eraseRubberBand=function(){this.shape.dispose(),this.shape=null},SelectAreaTracker.prototype.drawXORRect=function(a){if(null==this.shape){var b=this.view().selectiong;b.setColor("none"),b.setStrokeColor("black"),b.setStrokeWidth(1),this.shape=b.drawRect(a.x,a.y,a.width,a.height),this.shape.setAttribute("style",hdSelectionRectStyle)}else this.shape.setSize(a.width,a.height),this.shape.translate(a.x,a.y)},SelectAreaTracker.prototype.selectGroup=function(a){for(var b=this.drawing().figuresReverse();b.hasMoreElements();){var c=b.nextFigure(),d=c.displayBox();this.fSelectGroup.contains(d.x,d.y)&&this.fSelectGroup.contains(d.x+d.width,d.y+d.height)&&(a?this.view().toggleSelection(c):this.view().addToSelection(c))}},CreationTool.prototype=new AbstractTool,CreationTool.prototype.initCreationTool=function(a,b){this.initAbstractTool(a),void 0!=b&&(this.fPrototype=b)},CreationTool.prototype.activate=function(){this.activateCreationTool()},CreationTool.prototype.activateCreationTool=function(){this.activateAbstractTool(),this.view().setCursor("crosshair")},CreationTool.prototype.deactivate=function(){this.deactivateCreationTool()},CreationTool.prototype.deactivateCreationTool=function(){this.deactivateAbstractTool()},CreationTool.prototype.createFigure=function(a){return null==this.fPrototype?void alert("No protoype defined"):this.fPrototype.clone()},CreationTool.prototype.createdFigure=function(){return this.fCreatedFigure},CreationTool.prototype.mouseDown=function(a,b,c){this.creationToolMouseDown(a,b,c)},CreationTool.prototype.creationToolMouseDown=function(a,b,c){this.fAnchorPoint=new Point(b,c),this.fCreatedFigure=this.createFigure(),this.fCreatedFigure.displayBox(this.fAnchorPoint,new Point(b+1,c+1)),this.view().add(this.fCreatedFigure),this.view().drawDrawing()},CreationTool.prototype.mouseDrag=function(a,b,c){this.fCreatedFigure.displayBox(this.fAnchorPoint,new Point(b,c)),this.fCreatedFigure.getShape()&&this.fCreatedFigure.draw()},CreationTool.prototype.mouseUp=function(a,b,c){if(null!=this.fCreatedFigure){var d=!0;this.fCreatedFigure.isEmpty()&&(this.drawing().remove(this.fCreatedFigure),d=!1),this.view().drawDrawing(),this.editor().toolDone(),d&&this.fireViewEvent(this.fCreatedFigure,"Create"),this.fCreatedFigure=null}},ScribbleTool.prototype=new AbstractTool,ScribbleTool.prototype.initScribbleTool=function(a){this.initAbstractTool(a)},ScribbleTool.prototype.activate=function(){this.activateScribbleTool()},ScribbleTool.prototype.activateScribbleTool=function(){this.activateAbstractTool(),this.view().setCursor("crosshair"),this.view().clearSelection(),this.fScribble=null},ScribbleTool.prototype.deactivate=function(){this.deactivateScribbleTool()},ScribbleTool.prototype.deactivateScribbleTool=function(){this.deactivateAbstractTool(),null!=this.fScribble&&(this.fScribble.size().width<4||this.fScribble.size().height<4)&&this.drawing().remove(this.fScribble)},ScribbleTool.prototype.point=function(a,b){null==this.fScribble?(this.fScribble=new PolyLineFigure(a,b),this.view().add(this.fScribble)):(this.fLastX!=a||this.fLastY!=b)&&this.fScribble.addPoint(a,b),this.fLastX=a,this.fLastY=b},ScribbleTool.prototype.mouseDown=function(a,b,c){a.getClickCount()>=2?(this.fScribble=null,this.editor().toolDone()):this.point(a.getX(),a.getY())},ScribbleTool.prototype.mouseDrag=function(a,b,c){null!=this.fScribble&&this.point(a.getX(),a.getY())},ScribbleTool.prototype.mouseUp=function(a,b,c){this.fireViewEvent(this.fScribble,"Create"),this.editor().toolDone(),this.fScribble=null},DragTracker.prototype=new AbstractTool,DragTracker.prototype.initDragTracker=function(a,b){this.initAbstractTool(a),this.fAnchorFigure=b},DragTracker.prototype.mouseDown=function(a,b,c){this.fAnchorX=b,this.fAnchorY=c,this.fLastX=b,this.fLastY=c,a.isShiftDown()?(this.view().toggleSelection(this.fAnchorFigure),this.fAnchorFigure=null):this.view().selection().contains(this.fAnchorFigure)||(this.view().clearSelection(),this.view().addToSelection(this.fAnchorFigure)),this.view().setCursor("move")},DragTracker.prototype.mouseDrag=function(a,b,c){if(this.fView.selectionCount()<2)this.fAnchorFigure.moveBy(b-this.fLastX,c-this.fLastY),this.fAnchorFigure.draw();else for(var d=this.view().selectionElements();d.hasMoreElements();){var e=d.nextFigure();e.moveBy(b-this.fLastX,c-this.fLastY),e.draw()}this.fLastX=b,this.fLastY=c},DragTracker.prototype.mouseUp=function(a,b,c){if(this.fMoved=Math.abs(b-this.fAnchorX)>4||Math.abs(c-this.fAnchorY)>4,this.fMoved)for(var d=this.view().selectionElements();d.hasMoreElements();)this.fireViewEvent(d.nextFigure(),"Move");this.view().setCursor("default")},AbstractHandle.prototype=new Handle,AbstractHandle.prototype.initAbstractHandle=function(a){this.fOwner=a},AbstractHandle.prototype.locate=function(){},AbstractHandle.prototype.invokeStart=function(a,b,c){c.drawing()},AbstractHandle.prototype.invokeStep=function(a,b,c,d,e){e.drawing()},AbstractHandle.prototype.invokeEnd=function(a,b,c,d,e){e.drawing()},AbstractHandle.prototype.owner=function(){return this.fOwner},AbstractHandle.prototype.displayBox=function(){var a=this.locate();return new gRectangle(a.x-this.HANDLESIZE/2,a.y-this.HANDLESIZE/2,this.HANDLESIZE,this.HANDLESIZE)},AbstractHandle.prototype.containsPoint=function(a,b){return this.displayBox().contains(a,b)},AbstractHandle.prototype.createSVGContent=function(a){var b=this.displayBox();a.setColor(this.color),a.setStrokeWidth(1),a.setStrokeColor("black"),this.shape=a.drawRect(b.x,b.y,b.width,b.height),this.shape.setAttribute("shape-rendering","optimizeSpeed"),this.shape.setCursor(this.getCursorName())},AbstractHandle.prototype.draw=function(a){this.drawAbstractHandle(a)},AbstractHandle.prototype.drawAbstractHandle=function(a){this.created||(this.created=!0,this.createSVGContent(a));var b=this.displayBox();this.shape.setSize(b.width,b.height),this.shape.translate(b.x,b.y),void 0!=a&&a.addChild(this.shape.getNode())},AbstractHandle.prototype.getShape=function(){return this.shape},AbstractHandle.prototype.dispose=function(){null!=this.shape&&this.shape.dispose(),this.shape=null},AbstractHandle.prototype.getCursorName=function(){var a=null;switch(this.className){case"NorthEastHandle":a="ne-resize";break;case"EastHandle":a="e-resize";break;case"NorthHandle":a="n-resize";break;case"NorthWestHandle":a="nw-resize";break;case"SouthEastHandle":a="se-resize";break;case"SouthHandle":a="s-resize";break;case"SouthWestHandle":a="sw-resize";break;case"WestHandle":a="w-resize";break;default:a="default"}return a},LocatorHandle.prototype=new AbstractHandle,LocatorHandle.prototype.initLocatorHandle=function(a,b){this.initAbstractHandle(a),this.fLocator=b},LocatorHandle.prototype.locate=function(){return this.fLocator.locate(this.owner())},RadiusHandle.prototype=new AbstractHandle,RadiusHandle.prototype.initRadiusHandle=function(a){this.initAbstractHandle(a),this.fOwner=a,this.color="red"},RadiusHandle.prototype.createSVGContent=function(a){var b=this.displayBox();a.setColor(this.color),this.shape=a.drawOval(b.x+b.width/2,b.y+b.height/2,b.width,b.height),this.shape.setStrokeWidth(.5),this.shape.setStrokeColor("black"),this.shape.setCursor(this.getCursorName())},RadiusHandle.prototype.locate=function(){var a=this.fOwner.getArc(),b=this.fOwner.displayBox();return new Point(b.x+a.x/2+this.OFFSET,b.y+a.y/2+this.OFFSET)},RadiusHandle.prototype.invokeStart=function(a,b,c){this.fRadius=this.fOwner.getArc(),this.fRadius.x=this.fRadius.x/2,this.fRadius.y=this.fRadius.y/2},RadiusHandle.prototype.invokeStep=function(a,b,c,d,e){var f=a-c,g=b-d;r=this.fOwner.displayBox();var h=geom.range(0,r.width,2*(this.fRadius.x+f)),i=geom.range(0,r.height,2*(this.fRadius.y+g));this.fOwner.setArc(h,i)},HandleTracker.prototype=new AbstractTool,HandleTracker.prototype.initHandleTracker=function(a,b){this.initAbstractTool(a),this.fAnchorHandle=b},HandleTracker.prototype.mouseDown=function(a,b,c){this.fAnchorX=b,this.fAnchorY=c,this.fAnchorHandle.invokeStart(b,c,this.view()),this.view().setCursor(this.fAnchorHandle.getCursorName()),this.fAnchorHandle.shape.setVisibility(!0)},HandleTracker.prototype.mouseDrag=function(a,b,c){this.fAnchorHandle.invokeStep(b,c,this.fAnchorX,this.fAnchorY,this.view()),this.fAnchorHandle.owner().draw(),this.fAnchorHandle.shape.setVisibility(!0),this.fAnchorHandle.draw()},HandleTracker.prototype.mouseUp=function(a,b,c){this.fAnchorHandle.invokeEnd(b,c,this.fAnchorX,this.fAnchorY,this.view()),this.view().setCursor("default"),this.fireViewEvent(this.fAnchorHandle.fOwner,"Update")},AbstractLocator.prototype=new Locator,AbstractLocator.prototype.clone=function(){return null},AbstractLocator.prototype.write=function(a){return null},AbstractLocator.prototype.read=function(a){return null},RelativeLocator.prototype=new AbstractLocator,RelativeLocator.prototype.initRelativeLocator=function(a,b){this.fRelativeX=a,this.fRelativeY=b},RelativeLocator.prototype.locate=function(a){var b=a.displayBox();return new Point(b.x+b.width*this.fRelativeX,b.y+b.height*this.fRelativeY)},RelativeLocator.prototype.east=function(){return new RelativeLocator(1,.5)},RelativeLocator.prototype.north=function(){return new RelativeLocator(.5,0)},RelativeLocator.prototype.west=function(){return new RelativeLocator(0,.5)},RelativeLocator.prototype.northEast=function(){return new RelativeLocator(1,0)},RelativeLocator.prototype.northWest=function(){return new RelativeLocator(0,0)},RelativeLocator.prototype.south=function(){return new RelativeLocator(.5,1)},RelativeLocator.prototype.southEast=function(){return new RelativeLocator(1,1)},RelativeLocator.prototype.southWest=function(){return new RelativeLocator(0,1)},RelativeLocator.prototype.center=function(){return new RelativeLocator(.5,.5)};var relativeLocator=new RelativeLocator;NorthEastHandle.prototype=new LocatorHandle,NorthEastHandle.prototype.initNorthEastHandle=function(a){this.initLocatorHandle(a,relativeLocator.northEast())},NorthEastHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner().displayBox();this.owner().displayBox(new Point(f.x,Math.min(f.y+f.height,b)),new Point(Math.max(f.x,a),f.y+f.height))},EastHandle.prototype=new LocatorHandle,EastHandle.prototype.initEastHandle=function(a){this.initLocatorHandle(a,relativeLocator.east())},EastHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner().displayBox();this.owner().displayBox(new Point(f.x,f.y),new Point(Math.max(f.x,a),f.y+f.height))},NorthHandle.prototype=new LocatorHandle,NorthHandle.prototype.initNorthHandle=function(a){this.initLocatorHandle(a,relativeLocator.north())},NorthHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner().displayBox();this.owner().displayBox(new Point(f.x,Math.min(f.y+f.height,b)),new Point(f.x+f.width,f.y+f.height))},NorthWestHandle.prototype=new LocatorHandle,NorthWestHandle.prototype.initNorthWestHandle=function(a){this.initLocatorHandle(a,relativeLocator.northWest())},NorthWestHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner().displayBox();this.owner().displayBox(new Point(Math.min(f.x+f.width,a),Math.min(f.y+f.height,b)),new Point(f.x+f.width,f.y+f.height))},SouthEastHandle.prototype=new LocatorHandle,SouthEastHandle.prototype.initSouthEastHandle=function(a){this.initLocatorHandle(a,relativeLocator.southEast())},SouthEastHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner().displayBox();this.owner().displayBox(new Point(f.x,f.y),new Point(Math.max(f.x,a),Math.max(f.y,b)))},SouthHandle.prototype=new LocatorHandle,SouthHandle.prototype.initSouthHandle=function(a){this.initLocatorHandle(a,relativeLocator.south())},SouthHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner().displayBox();this.owner().displayBox(new Point(f.x,f.y),new Point(f.x+f.width,Math.max(f.y,b)))},SouthWestHandle.prototype=new LocatorHandle,SouthWestHandle.prototype.initSouthWestHandle=function(a){this.initLocatorHandle(a,relativeLocator.southWest())},SouthWestHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner().displayBox();this.owner().displayBox(new Point(Math.min(f.x+f.width,a),f.y),new Point(f.x+f.width,Math.max(f.y,b)))},WestHandle.prototype=new LocatorHandle,WestHandle.prototype.initWestHandle=function(a){this.initLocatorHandle(a,relativeLocator.west())},WestHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner().displayBox();this.owner().displayBox(new Point(Math.min(f.x+f.width,a),f.y),new Point(f.x+f.width,f.y+f.height))},BoxHandleKit.prototype.initBoxHandleKit=function(){},BoxHandleKit.prototype.addCornerHandles=function(a,b){b.addElement(this.southEast(a)),b.addElement(this.southWest(a)),b.addElement(this.northEast(a)),b.addElement(this.northWest(a))},BoxHandleKit.prototype.addHandles=function(a,b){this.addCornerHandles(a,b),b.addElement(this.south(a)),b.addElement(this.north(a)),b.addElement(this.east(a)),b.addElement(this.west(a))},BoxHandleKit.prototype.south=function(a){return new SouthHandle(a)},BoxHandleKit.prototype.southEast=function(a){return new SouthEastHandle(a)},BoxHandleKit.prototype.southWest=function(a){return new SouthWestHandle(a)},BoxHandleKit.prototype.north=function(a){return new NorthHandle(a)},BoxHandleKit.prototype.northEast=function(a){return new NorthEastHandle(a)},BoxHandleKit.prototype.northWest=function(a){return new NorthWestHandle(a)},BoxHandleKit.prototype.east=function(a){return new EastHandle(a)},BoxHandleKit.prototype.west=function(a){return new WestHandle(a)},BoxHandleKit.prototype.toString=function(){return this.className};var boxHandleKit=new BoxHandleKit;TextHolder.prototype.textDisplayBox=function(){},TextHolder.prototype.getText=function(){},TextHolder.prototype.setText=function(a){},TextHolder.prototype.acceptsTyping=function(){},TextHolder.prototype.overlayColumns=function(){},TextHolder.prototype.connect=function(a){},TextHolder.prototype.getFont=function(){},NullHandle.prototype=new LocatorHandle,NullHandle.prototype.initNullHandle=function(a,b){this.initLocatorHandle(a,b)},NullHandle.prototype.createSVGContent=function(a){var b=this.displayBox();a.setColor("none"),this.shape=a.drawRect(b.x,b.y,b.width,b.height),this.shape.setStrokeWidth(1),this.shape.setStrokeColor("black"),this.shape.setAttribute("shape-rendering","optimizeSpeed"),this.shape.setCursor(this.getCursorName())},ActionTool.prototype=new AbstractTool,ActionTool.prototype.initActionTool=function(a){this.initAbstractTool(a)},ActionTool.prototype.mouseDown=function(a,b,c){var d=this.drawing().findFigure(b,c);null!=d&&(this.view().addToSelection(d),this.action(d))},ActionTool.prototype.mouseUp=function(a,b,c){this.editor().toolDone()},ActionTool.prototype.action=function(a){},FigureAttributes.prototype.initFigureAttributes=function(){},FigureAttributes.prototype.get=function(a){return this.fMap.get(a)},FigureAttributes.prototype.set=function(a,b){this.fMap.put(a,b)},FigureAttributes.prototype.hasDefined=function(a){return this.fMap.containsKey(a)},FigureAttributes.prototype.clone=function(){var a=new FigureAttributes;return a.fMap=this.fMap.clone(),a},FigureAttributes.prototype.read=function(a){},FigureAttributes.prototype.write=function(a){},AttributeFigure.prototype=new AbstractFigure,AttributeFigure.prototype.initAttributeFigure=function(){this.initAbstractFigure()},AttributeFigure.prototype.draw=function(a){this.drawAttributeFigure(a)},AttributeFigure.prototype.drawAttributeFigure=function(a){this.drawAbstractFigure(a)},AttributeFigure.prototype.getFillColor=function(){return this.getAttribute("FillColor")},AttributeFigure.prototype.getFrameColor=function(){return this.getAttribute("FrameColor")},AttributeFigure.prototype.initializeAttributes=function(){this.fgDefaultAttributes=new FigureAttributes,this.fgDefaultAttributes.set("Opacity",1),this.fgDefaultAttributes.set("FrameWidth",1),this.fgDefaultAttributes.set("FrameColor","black"),this.fgDefaultAttributes.set("FillColor",new Color(7396243).getRGBAsString()),this.fgDefaultAttributes.set("TextColor","black"),this.fgDefaultAttributes.set("ArrowMode",0),this.fgDefaultAttributes.set("FontName","Helvetica"),this.fgDefaultAttributes.set("FontSize",12),this.fgDefaultAttributes.set("FontStyle",(new Font).PLAIN)},AttributeFigure.prototype.getDefaultAttribute=function(a){return null==this.fgDefaultAttributes&&this.initializeAttributes(),this.fgDefaultAttributes.get(a)},AttributeFigure.prototype.getAttribute=function(a){return this.getAttributeAttributeFigure(a)},AttributeFigure.prototype.getAttributeAttributeFigure=function(a){return null!=this.fAttributes&&this.fAttributes.hasDefined(a)?this.fAttributes.get(a):this.getDefaultAttribute(a)},AttributeFigure.prototype.setAttribute=function(a,b){this.setAttributeAttributeFigure(a,b)},AttributeFigure.prototype.setAttributeAttributeFigure=function(a,b){null==this.fAttributes&&(this.fAttributes=new FigureAttributes),this.fAttributes.set(a,b),this.updateShapeAttributes(),this.changed()},AttributeFigure.prototype.updateShapeAttributes=function(){this.updateShapeAttributesAttributeFigure()},AttributeFigure.prototype.updateShapeAttributesAttributeFigure=function(){this.isCreated()&&this.shape.setColor(this.getAttribute("FillColor")),this.isCreated()&&this.shape.setStrokeColor(this.getAttribute("FrameColor")),this.isCreated()&&this.shape.setOpacity(this.getAttribute("Opacity")),this.isCreated()&&this.shape.setStrokeWidth(this.getAttribute("FrameWidth"))},AttributeFigure.prototype.write=function(a){},AttributeFigure.prototype.read=function(a){},AttributeFigure.prototype.serialize=function(){return this.serializeAttributeFigure()},AttributeFigure.prototype.serializeAttributeFigure=function(){var a=new Hashtable;return a.put("fillColor",this.getAttribute("FillColor")),a.put("frameColor",this.getAttribute("FrameColor")),a.put("frameWidth",this.getAttribute("FrameWidth")),a.put("opacity",this.getAttribute("Opacity")),this.serializeAbstractFigure()+a.serialize()},AttributeFigure.prototype.deserialize=function(a){return this.deserializeAttributeFigure(a)},AttributeFigure.prototype.deserializeAttributeFigure=function(a){var b=this.deserializeAbstractFigure(a);return this.setAttribute("FillColor",b.get("fillColor")),this.setAttribute("FrameColor",b.get("frameColor")),this.setAttribute("FrameWidth",b.get("frameWidth")),this.setAttribute("Opacity",b.get("opacity")),b},AttributeFigure.prototype.serializeAsRDF=function(a,b){return this.serializeAsRDFAttributeFigure(a,b)},AttributeFigure.prototype.serializeAsRDFAttributeFigure=function(a,b){var c=this.shape.getNode().nodeName,d="<"+a+c+"_"+this.myCount+"/historyNode_"+this.historyNodeCounter+"> ",e="";return e+=d+' svg:fill "'+this.getAttribute("FillColor")+'" . ',e+=d+' svg:stroke "'+this.getAttribute("FrameColor")+'" . ',e+=d+" svg:stroke-width "+this.getAttribute("FrameWidth")+" . ",e+=d+" svg:opacity "+this.getAttribute("Opacity")+" . ",e=this.serializeAsRDFAbstractFigure(a,b)+e},DecoratorFigure.prototype=new AttributeFigure,DecoratorFigure.prototype.initDecoratorFigure=function(a){this.initAbstractFigure(),(void 0!=a||null!=a)&&this.decorate(a)},DecoratorFigure.prototype.connectionInsets=function(){return this.connectionInsetsDecoratorFigure()},DecoratorFigure.prototype.connectionInsetsDecoratorFigure=function(){return this.fComponent.connectionInsets()},DecoratorFigure.prototype.canConnect=function(){return this.fComponent.canConnect()},DecoratorFigure.prototype.containsPoint=function(a,b){return this.fComponent.containsPoint(a,b)},DecoratorFigure.prototype.decorate=function(a){this.fComponent=a,this.fComponent.addToContainer(this)},DecoratorFigure.prototype.peelDecoration=function(){return this.fComponent.removeFromContainer(this),this.fComponent},DecoratorFigure.prototype.displayBox=function(){return this.fComponent.displayBox()},DecoratorFigure.prototype.basicDisplayBox=function(a,b){this.fComponent.basicDisplayBox(a,b)},DecoratorFigure.prototype.draw=function(a){this.drawDecoratorFigure(a)},DecoratorFigure.prototype.drawDecoratorFigure=function(a){this.fComponent.draw(a),this.drawAbstractFigure(a)},DecoratorFigure.prototype.findFigureInside=function(a,b){return this},DecoratorFigure.prototype.handles=function(){return this.handlesDecoratorFigure()},DecoratorFigure.prototype.handlesDecoratorFigure=function(){return this.fComponent.handles()},DecoratorFigure.prototype.includes=function(a){return this.includesAbstractFigure(a)||this.fComponent.includes(a)},DecoratorFigure.prototype.moveBy=function(a,b){this.fComponent.moveBy(a,b)},DecoratorFigure.prototype.basicMoveBy=function(a,b){},DecoratorFigure.prototype.figureChanged=function(a){},DecoratorFigure.prototype.figureRemoved=function(a){},DecoratorFigure.prototype.figureRequestUpdate=function(a){null!=this.listener()&&this.listener().figureRequestUpdate(a)},DecoratorFigure.prototype.figureRequestRemove=function(a){null!=this.listener()&&this.listener().figureRequestRemove(new FigureChangeEvent(this))},DecoratorFigure.prototype.figures=function(){return this.fComponent.figures()},DecoratorFigure.prototype.decompose=function(){return this.fComponent.decompose()},DecoratorFigure.prototype.setAttribute=function(a,b){this.fComponent.setAttribute(a,b)},DecoratorFigure.prototype.getAttribute=function(a){return this.fComponent.getAttribute(a)},DecoratorFigure.prototype.connectedTextLocator=function(a){return this.fComponent.connectedTextLocator(a)},DecoratorFigure.prototype.connectorAt=function(a,b){return this.fComponent.connectorAt(a,b)},DecoratorFigure.prototype.connectorVisibility=function(a){this.fComponent.connectorVisibility(a)},DecoratorFigure.prototype.dispose=function(){this.disposeDecoratorFigure()},DecoratorFigure.prototype.disposeDecoratorFigure=function(){this.fComponent.dispose(),this.disposeAbstractFigure()},DecoratorFigure.prototype.release=function(){this.fComponent.removeFromContainer(this),this.fComponent.release(),this.abstractFigureRelease()},DecoratorFigure.prototype.write=function(a){},DecoratorFigure.prototype.read=function(a){},RectangleFigure.prototype=new AttributeFigure,RectangleFigure.prototype.initRectangleFigure=function(a,b){return this.initAttributeFigure(),void 0==a&&void 0==b?void this.initRectangleFigure(new Point(0,0),new Point(0,0)):void this.basicDisplayBox(a,b)},RectangleFigure.prototype.basicDisplayBox=function(a,b){this.fDisplayBox=new gRectangle(a),this.fDisplayBox.add(b)},RectangleFigure.prototype.handles=function(a){(void 0==a||null==a)&&(a=this);var b=new Vector;return boxHandleKit.addHandles(a,b),b},RectangleFigure.prototype.ret_displayBox=function(){return new gRectangle(this.fDisplayBox.x,this.fDisplayBox.y,this.fDisplayBox.width,this.fDisplayBox.height)},RectangleFigure.prototype.basicMoveBy=function(a,b){
this.fDisplayBox.translate(a,b)},RectangleFigure.prototype.createSVGContent=function(a){var b=this.displayBox();this.shape=a.drawRect(b.x,b.y,b.width,b.height),this.updateShapeAttributes()},RectangleFigure.prototype.draw=function(a){this.drawRectangleFigure(a)},RectangleFigure.prototype.drawRectangleFigure=function(a){this.drawAttributeFigure(a);var b=this.displayBox();this.shape.setSize(b.width,b.height),this.shape.translate(b.x,b.y)},RectangleFigure.prototype.write=function(a){},RectangleFigure.prototype.read=function(){},RectangleFigure.prototype.clone=function(){return new RectangleFigure(new Point(0,0),new Point(0,0))};var ARROW_TIP_NONE=0,ARROW_TIP_START=1,ARROW_TIP_END=2,ARROW_TIP_BOTH=3;PolyLineFigure.prototype=new AbstractFigure,PolyLineFigure.prototype.initPolyLineFigure=function(a,b){if(this.initAbstractFigure(),void 0==a&&void 0==b)return void this.initPolyLineFigure(4);if(void 0!=a&&void 0==b){var c=a;return void(this.fPoints=new Vector(c))}this.fPoints=new Vector,this.fPoints.addElement(new Point(a,b))},PolyLineFigure.prototype.ret_displayBox=function(){for(var a=this.points(),b=new gRectangle(a.nextElement());a.hasMoreElements();)b.add(a.nextElement());return b},PolyLineFigure.prototype.basicDisplayBox=function(a,b){},PolyLineFigure.prototype.isEmpty=function(){return this.size().width<3&&this.size().height<3},PolyLineFigure.prototype.handles=function(){var a=new Vector;return a.addElement(new NullHandle(this,relativeLocator.northWest())),a.addElement(new NullHandle(this,relativeLocator.northEast())),a.addElement(new NullHandle(this,relativeLocator.southEast())),a.addElement(new NullHandle(this,relativeLocator.southWest())),a},PolyLineFigure.prototype.addPoint=function(a,b){this.fPoints.addElement(new Point(a,b)),this.addNewPointToPath(a,b),this.changed()},PolyLineFigure.prototype.addNewPointToPath=function(a,b){null!=this.shape&&(this.d=this.shape.getAttribute("d"),"M -1 -1"==this.d?this.d=" M "+a+" "+b:this.d+=" L "+a+" "+b,this.shape.setAttribute("d",this.d))},PolyLineFigure.prototype.updatePath=function(){if(!this.pathChanged)return void this.shape.setAttribute("d",this.d);this.pathChanged=!1;var a=this.fPoints.elements(),b=a.nextElement();for(this.d=" M "+(b.x-this.shape.x)+" "+(b.y-this.shape.y);a.hasMoreElements();)b=a.nextElement(),this.d+=" L "+(b.x-this.shape.x)+" "+(b.y-this.shape.y);this.shape.setAttribute("d",this.d)},PolyLineFigure.prototype.points=function(){return this.fPoints.elements()},PolyLineFigure.prototype.pointCount=function(){return this.fPoints.size()},PolyLineFigure.prototype.basicMoveBy=function(a,b){for(var c=this.fPoints.elements();c.hasMoreElements();)c.nextElement().translate(a,b);null!=this.getShape()&&this.getShape().moveBy(a,b)},PolyLineFigure.prototype.setPointAt=function(a,b){this.willChange(),this.fPoints.setElementAt(a,b),this.pathChanged=!0,this.changed()},PolyLineFigure.prototype.insertPointAt=function(a,b){this.fPoints.insertElementAt(a,b),this.changed()},PolyLineFigure.prototype.removePointAt=function(a){this.willChange(),this.fPoints.removeElementAt(a),this.changed()},PolyLineFigure.prototype.splitSegment=function(a,b){var c=this.findSegment(a,b);return-1!=c&&this.insertPointAt(new Point(a,b),c+1),c+1},PolyLineFigure.prototype.pointAt=function(a){return this.fPoints.elementAt(a)},PolyLineFigure.prototype.joinSegments=function(a,b){for(var c=1;c<this.fPoints.size()-1;c++){var d=this.pointAt(c);if(Geom.length(a,b,d.x,d.y)<3)return this.removePointAt(c),!0}return!1},PolyLineFigure.prototype.connectorAt=function(a,b){return new PolyLineConnector(this)},PolyLineFigure.prototype.updatePolyLineAttributes=function(){this.shape.setColor("none"),this.shape.setStrokeWidth(this.getFrameWidth()),this.shape.setStrokeColor(this.getFrameColor()),this.shape.setOpacity(this.getOpacity())},PolyLineFigure.prototype.createSVGContent=function(a){this.shape=a.drawPath(0,0,"M -1 -1"),this.updatePolyLineAttributes()},PolyLineFigure.prototype.draw=function(a){this.drawPolyLineFigure(a)},PolyLineFigure.prototype.drawPolyLineFigure=function(a){this.drawAbstractFigure(a),this.updatePath()},PolyLineFigure.prototype.locator=function(a){return new PolyLineLocator(a)},PolyLineFigure.prototype.getAttribute=function(a){return"FrameColor"==a?this.getFrameColor():"FillColor"==a?"none":"FrameWidth"==a?this.getFrameWidth():"Opacity"==a?this.getOpacity():void 0},PolyLineFigure.prototype.setAttribute=function(a,b){"FrameColor"==a&&this.setFrameColor(b),"FrameWidth"==a&&this.setFrameWidth(b),"Opacity"==a&&this.setOpacity(b)},PolyLineFigure.prototype.getFrameColor=function(){return this.fFrameColor},PolyLineFigure.prototype.setFrameColor=function(a){this.fFrameColor=a,null!=this.shape&&this.shape.setStrokeColor(a)},PolyLineFigure.prototype.getFrameWidth=function(){return this.fFrameWidth},PolyLineFigure.prototype.setFrameWidth=function(a){this.fFrameWidth=a,null!=this.shape&&this.shape.setStrokeWidth(a)},PolyLineFigure.prototype.getOpacity=function(){return this.fOpacity},PolyLineFigure.prototype.setOpacity=function(a){this.fOpacity=a,null!=this.shape&&this.shape.setOpacity(a)},PolyLineFigure.prototype.write=function(a){},PolyLineFigure.prototype.read=function(){},PolyLineFigure.prototype.clone=function(){return new PolyLineFigure(0,0)},PolyLineFigure.prototype.containsPoint=function(a,b){var c=this.displayBox();if(c.grow(4,4),c.contains(a,b))return!0;for(var d,e,f=0;f<this.fPoints.size()-1;f++)if(d=this.fPoints.elementAt(f),e=this.fPoints.elementAt(f+1),geom.lineContainsPoint(d.x,d.y,e.x,e.y,a,b))return!0;return!1},PolyLineFigure.prototype.findSegment=function(a,b){},PolyLineFigure.prototype.getPoints=function(){for(var a="",b=this.fPoints.elements();b.hasMoreElements();){var c=b.nextElement();a+=c.x+"@"+c.y+","}return a},PolyLineFigure.prototype.setPoints=function(a){this.pathChanged=!0,this.fPoints=new Vector;for(var b=a.split(","),c=0;c<b.length;c++){var d=b[c].split("@");if(void 0!=d&&null!=d&&d.length>1){var e=parseFloat(d[0]),f=parseFloat(d[1]);isNaN(e)||isNaN(f)||this.addPoint(e,f)}}},PolyLineFigure.prototype.serialize=function(){return this.serializePolyLineFigure()},PolyLineFigure.prototype.serializePolyLineFigure=function(){var a=new Hashtable;return a.put("fillColor",this.getAttribute("FillColor")),a.put("frameColor",this.getAttribute("FrameColor")),a.put("frameWidth",this.getAttribute("FrameWidth")),a.put("opacity",this.getAttribute("Opacity")),this instanceof PolyLineFigure&&a.put("points",this.getPoints()),this.serializeAbstractFigure()+a.serialize()},PolyLineFigure.prototype.deserialize=function(a){return this.deserializePolyLineFigure(a)},PolyLineFigure.prototype.deserializePolyLineFigure=function(a){var b=this.deserializeAbstractFigure(a);return this.setAttribute("FillColor",b.get("fillColor")),this.setAttribute("FrameColor",b.get("frameColor")),this.setAttribute("FrameWidth",b.get("frameWidth")),this.setAttribute("Opacity",b.get("opacity")),this instanceof PolyLineFigure&&this.setPoints(b.get("points")),b},PolyLineFigure.prototype.serializeAsRDF=function(a,b){return this.serializeAsRDFPolyLineFigure(a,b)},PolyLineFigure.prototype.serializeAsRDFPolyLineFigure=function(a,b){var c=this.shape.getNode().nodeName,d="<"+a+c+"_"+this.myCount+"/historyNode_"+this.historyNodeCounter+"> ",e="";return e+=d+' svg:fill "'+this.getAttribute("FillColor")+'" . ',e+=d+' svg:stroke "'+this.getAttribute("FrameColor")+'" . ',e+=d+" svg:stroke-width "+this.getAttribute("FrameWidth")+" . ",e+=d+" svg:opacity "+this.getAttribute("Opacity")+" . ",("PolyLineFigure"==this.className||"FireBoundaryFigure"==this.className)&&(e+=d+' svg:points "'+this.getPoints()+'" . '),e=this.serializeAsRDFAbstractFigure(a,b)+e},EllipseFigure.prototype=new AttributeFigure,EllipseFigure.prototype.initEllipseFigure=function(a,b){return this.initAttributeFigure(),a||b?void this.basicDisplayBox(a,b):void this.initEllipseFigure(new Point(0,0),new Point(0,0))},EllipseFigure.prototype.basicDisplayBox=function(a,b){this.fDisplayBox=new gRectangle(a),this.fDisplayBox.add(b)},EllipseFigure.prototype.handles=function(a){(void 0==a||null==a)&&(a=this);var b=new Vector;return boxHandleKit.addHandles(a,b),b},EllipseFigure.prototype.ret_displayBox=function(){return new gRectangle(this.fDisplayBox.x,this.fDisplayBox.y,this.fDisplayBox.width,this.fDisplayBox.height)},EllipseFigure.prototype.basicMoveBy=function(a,b){this.fDisplayBox.translate(a,b);this.displayBox()},EllipseFigure.prototype.createSVGContent=function(a){var b=this.displayBox();this.shape=a.drawOval(b.x,b.y,b.width/2,b.height/2),this.updateShapeAttributes()},EllipseFigure.prototype.draw=function(a){this.drawEllipseFigure(a)},EllipseFigure.prototype.drawEllipseFigure=function(a){this.drawAttributeFigure(a);var b=this.displayBox();this.shape.setRadius(b.width/2,b.height/2),this.shape.translate(b.x,b.y)},EllipseFigure.prototype.write=function(a){},EllipseFigure.prototype.read=function(){},EllipseFigure.prototype.clone=function(){return new EllipseFigure(new Point(0,0),new Point(0,0))},ImageFigure.prototype=new RectangleFigure,ImageFigure.prototype.initImageFigure=function(a,b,c){this.initRectangleFigure(a,b),void 0==c?this.fFileName=hdImageURL:this.fFileName=c},ImageFigure.prototype.createSVGContent=function(a){var b=this.displayBox();this.shape=a.drawImage(b.x,b.y,b.width,b.height,this.fFileName),this.shape.setAttribute("preserveAspectRatio",this.preserveAspectRatio)},ImageFigure.prototype.getURL=function(){return this.fFileName},ImageFigure.prototype.setURL=function(a){this.fFileName=a,null!=this.shape&&this.shape.changeHref(this.fFileName)},ImageFigure.prototype.clone=function(){return new ImageFigure(new Point(0,0),new Point(0,0),this.fFileName)},ImageFigure.prototype.serialize=function(){return this.serializeImageFigure()},ImageFigure.prototype.serializeImageFigure=function(){var a=new Hashtable;return a.put("url",this.getURL()),a.put("opacity",this.getAttribute("Opacity")),this.serializeAbstractFigure()+a.serialize()},ImageFigure.prototype.deserialize=function(a){return this.deserializeImageFigure(a)},ImageFigure.prototype.deserializeImageFigure=function(a){var b=this.deserializeAbstractFigure(a);return this.setURL(b.get("url")),this.setAttribute("Opacity",b.get("opacity")),b},ImageFigure.prototype.serializeAsRDF=function(a,b){return this.serializeAsRDFImageFigure(a,b)},ImageFigure.prototype.serializeAsRDFImageFigure=function(a,b){var c=this.shape.getNode().nodeName,d="<"+a+c+"_"+this.myCount+"/historyNode_"+this.historyNodeCounter+"> ",e=d+' xlink:href "'+this.getURL()+'" . ';return e+=d+" svg:opacity "+this.getAttribute("Opacity")+" . ",e=this.serializeAsRDFAbstractFigure(a,b)+e},RoundRectangleFigure.prototype=new AttributeFigure,RoundRectangleFigure.prototype.initRoundRectangleFigure=function(a,b){return this.initAttributeFigure(),a||b?void this.basicDisplayBox(a,b):void this.initRoundRectangleFigure(new Point(0,0),new Point(0,0))},RoundRectangleFigure.prototype.basicDisplayBox=function(a,b){this.fDisplayBox=new gRectangle(a),this.fDisplayBox.add(b)},RoundRectangleFigure.prototype.setArc=function(a,b){this.willChange(),this.fArcWidth=a,this.fArcHeight=b,this.changed()},RoundRectangleFigure.prototype.getArc=function(){return new Point(this.fArcWidth,this.fArcHeight)},RoundRectangleFigure.prototype.handles=function(a){(void 0==a||null==a)&&(a=this);var b=new Vector;return boxHandleKit.addHandles(a,b),b.addElement(new RadiusHandle(this)),b},RoundRectangleFigure.prototype.ret_displayBox=function(){return new gRectangle(this.fDisplayBox.x,this.fDisplayBox.y,this.fDisplayBox.width,this.fDisplayBox.height)},RoundRectangleFigure.prototype.basicMoveBy=function(a,b){this.fDisplayBox.translate(a,b)},RoundRectangleFigure.prototype.createSVGContent=function(a){var b=this.displayBox();this.shape=a.drawRoundRect(b.x,b.y,b.width,b.height,this.fArcWidth,this.fArcHeight),this.updateShapeAttributes()},RoundRectangleFigure.prototype.draw=function(a){this.drawRoundRectangleFigure(a)},RoundRectangleFigure.prototype.drawRoundRectangleFigure=function(a){this.drawAttributeFigure(a);var b=this.displayBox();this.shape.setSize(b.width,b.height),this.shape.translate(b.x,b.y),this.shape.setRadius(this.fArcWidth,this.fArcHeight)},RoundRectangleFigure.prototype.connectionInsets=function(){return new Insets(this.fArcHeight/2,this.fArcWidth/2,this.fArcHeight/2,this.fArcWidth/2)},RoundRectangleFigure.prototype.connectorAt=function(a,b){return new ShortestDistanceConnector(this)},RoundRectangleFigure.prototype.write=function(a){},RoundRectangleFigure.prototype.read=function(){},RoundRectangleFigure.prototype.clone=function(){return new RoundRectangleFigure(new Point(0,0),new Point(0,0))},RoundRectangleFigure.prototype.serialize=function(){return this.serializeRoundRectangleFigure()},RoundRectangleFigure.prototype.serializeRoundRectangleFigure=function(){var a=new Hashtable;return a.put("arcWidth",this.fArcWidth),a.put("arcHeight",this.fArcHeight),this.serializeAttributeFigure()+a.serialize()},RoundRectangleFigure.prototype.deserialize=function(a){return this.deserializeRoundRectangleFigure(a)},RoundRectangleFigure.prototype.deserializeRoundRectangleFigure=function(a){var b=this.deserializeAttributeFigure(a),c=parseFloat(b.get("arcWidth")),d=parseFloat(b.get("arcHeight"));return this.setArc(c,d),b},RoundRectangleFigure.prototype.serializeAsRDF=function(a,b){return this.serializeAsRDFRoundRectangleFigure(a,b)},RoundRectangleFigure.prototype.serializeAsRDFRoundRectangleFigure=function(a,b){var c=this.shape.getNode().nodeName,d="<"+a+c+"_"+this.myCount+"/historyNode_"+this.historyNodeCounter+"> ",e="";return e+=d+" svg:rx "+this.fArcWidth+" . ",e+=d+" svg:ry "+this.fArcHeight+" . ",e=this.serializeAsRDFAttributeFigure(a,b)+e},TextFigure.prototype=new AttributeFigure,TextFigure.prototype.initTextFigure=function(){this.initAttributeFigure(),this.setAttribute("FrameColor","none"),this.setAttribute("FillColor","black")},TextFigure.prototype.moveBy=function(a,b){this.willChange(),this.basicMoveBy(a,b),null!=this.fLocator&&this.fLocator.moveBy(a,b),this.changed()},TextFigure.prototype.basicMoveBy=function(a,b){this.fOriginX+=a,this.fOriginY+=b},TextFigure.prototype.basicDisplayBox=function(a,b){this.fOriginX=a.x,this.fOriginY=a.y},TextFigure.prototype.ret_displayBox=function(){var a=this.textExtent();return new gRectangle(this.fOriginX,this.fOriginY,a.width,a.height)},TextFigure.prototype.textDisplayBox=function(){return this.displayBox()},TextFigure.prototype.readOnly=function(){return this.fIsReadOnly},TextFigure.prototype.setReadOnly=function(a){this.fIsReadOnly=a},TextFigure.prototype.getFont=function(){return this.fFont},TextFigure.prototype.setFont=function(a){this.willChange(),this.fFont=a,null!=this.shape&&this.shape.setFont(this.fFont),this.changed()},TextFigure.prototype.changed=function(){this.updateLocation()},TextFigure.prototype.createCurrentFont=function(){return new Font(this.fgCurrentFontName,this.fgCurrentFontStyle,this.fgCurrentFontSize+"pt")},TextFigure.prototype.setCurrentFontName=function(a){this.fgCurrentFontName=a},TextFigure.prototype.setCurrentFontSize=function(a){this.fgCurrentFontSize=a},TextFigure.prototype.setCurrentFontStyle=function(a){this.fgCurrentFontStyle=a},TextFigure.prototype.getAttribute=function(a){var b=this.getFont();return"FontSize"==a?b.getSize():"FontStyle"==a?b.getNamedStyle():"FontName"==a?b.getName():this.getAttributeAttributeFigure(a)},TextFigure.prototype.setAttribute=function(a,b){var c=this.getFont();"FontSize"==a?this.setFont(new Font(c.getName(),c.getNamedStyle(),parseInt(b))):"FontStyle"==a?(c.setStyle(parseInt(b)),this.setFont(new Font(c.getName(),c.getNamedStyle(),c.getSize()))):"FontName"==a?this.setFont(new Font(b,c.getNamedStyle(),c.getSize())):this.setAttributeAttributeFigure(a,b)},TextFigure.prototype.getText=function(){return this.fText},TextFigure.prototype.setText=function(a){void 0!=a&&null!=a&&a!=this.fText&&(this.willChange(),this.fText=a,null!=this.shape&&this.shape.setText(a),this.changed())},TextFigure.prototype.acceptsTyping=function(){return!this.fIsReadOnly},TextFigure.prototype.createSVGContent=function(a){var b=this.displayBox();this.shape=a.drawText(b.x,b.y,this.fText),this.shape.setToBaseLine(),this.updateShapeAttributes()},TextFigure.prototype.draw=function(a){this.drawTextFigure(a)},TextFigure.prototype.drawTextFigure=function(a){this.drawAttributeFigure(a);var b=this.displayBox();this.shape.setFont(this.getFont()),this.shape.setSize(b.width,b.height),this.shape.translate(b.x,b.y)},TextFigure.prototype.textExtent=function(){return null==this.shape?new Dimension(0,0):(this.fWidth=this.shape.getStringWidth(),this.fHeight=this.shape.getStringHeight(),new Dimension(this.fWidth,this.fHeight))},TextFigure.prototype.markDirty=function(){this.fSizeIsDirty=!0},TextFigure.prototype.overlayColumns=function(){var a=this.getText().length,b=20;return 0!=a&&(b=this.getText().length+3),b},TextFigure.prototype.handles=function(){var a=new Vector;return a.addElement(new NullHandle(this,relativeLocator.northWest())),a.addElement(new NullHandle(this,relativeLocator.northEast())),a.addElement(new NullHandle(this,relativeLocator.southEast())),a.addElement(new FontSizeHandle(this,relativeLocator.southWest())),a},TextFigure.prototype.connect=function(a){},TextFigure.prototype.figureChanged=function(a){this.updateLocation()},TextFigure.prototype.figureRemoved=function(a){null!=this.listener()&&this.listener().figureRequestRemove(new FigureChangeEvent(this))},TextFigure.prototype.figureRequestRemove=function(a){},TextFigure.prototype.figureInvalidated=function(a){},TextFigure.prototype.figureRequestUpdate=function(a){},TextFigure.prototype.updateLocation=function(){},TextFigure.prototype.release=function(){this.abstractFigureRelease(),null!=this.fObservedFigure&&this.fObservedFigure.removeFigureChangeListener(this)},TextFigure.prototype.disconnect=function(){},TextFigure.prototype.write=function(a){},TextFigure.prototype.read=function(){},TextFigure.prototype.clone=function(){return new TextFigure(!0)},TextFigure.prototype.serialize=function(){return this.serializeTextFigure()},TextFigure.prototype.serializeTextFigure=function(){var a=new Hashtable;return a.put("fontName",this.getAttribute("FontName")),a.put("fontSize",this.getAttribute("FontSize")),a.put("fontStyle",this.getAttribute("FontStyle")),null!=this.getText()&&a.put("text",this.getText()),this.serializeAttributeFigure()+a.serialize()},TextFigure.prototype.deserialize=function(a){return this.deserializeTextFigure(a)},TextFigure.prototype.deserializeTextFigure=function(a){var b=this.deserializeAttributeFigure(a);return this.setText(b.containsKey("text")?b.get("text"):" "),this.setFont(new Font(b.get("fontName"),b.get("fontStyle"),b.get("fontSize"))),b},TextFigure.prototype.serializeAsRDF=function(a,b){return this.serializeAsRDFTextFigure(a,b)},TextFigure.prototype.serializeAsRDFTextFigure=function(a,b){var c=this.shape.getNode().nodeName,d="<"+a+c+"_"+this.myCount+"/historyNode_"+this.historyNodeCounter+"> ",e=d+' svg:font-family "'+this.getAttribute("FontName")+'" . ';return e+=d+' svg:font-style "'+this.getAttribute("FontStyle")+'" . ',e+=d+' svg:font-size "'+this.getAttribute("FontSize")+'" . ',null!=this.getText()&&(e+=d+' svg:content "'+this.getText()+'" . '),e=this.serializeAsRDFAttributeFigure(a,b)+e},TextTool.prototype=new CreationTool,TextTool.prototype.initTextTool=function(a,b){this.initCreationTool(a,b)},TextTool.prototype.activate=function(){this.activateTextTool()},TextTool.prototype.activateTextTool=function(){this.activateCreationTool(),this.view().setCursor("text")},TextTool.prototype.deactivate=function(){this.deactivateTextTool()},TextTool.prototype.deactivateTextTool=function(){this.deactivateCreationTool(),this.endEdit()},TextTool.prototype.fieldBounds=function(a){var b=a.textDisplayBox(),c=a.overlayColumns(),d=this.fTextField.getPreferredSize(c);return new gRectangle(b.x,b.y,d.width,d.height)},TextTool.prototype.endEdit=function(a){null!=this.fTypingTarget&&(this.fTextField.getText().length>0?(this.fTypingTarget.setText(this.fTextField.getText()),this.fireViewEvent(this.fTypingTarget,"Update")):(this.drawing().remove(this.fTypingTarget),this.fireViewEvent(this.fTypingTarget,"Remove")),this.fTypingTarget=null,this.fTextField.endOverlay())},TextTool.prototype.beginEdit=function(a){null==this.fTextField&&(this.fTextField=new FloatingTextField),a!=this.fTypingTarget&&null!=this.fTypingTarget&&this.endEdit(),this.fTextField.createOverlay(this.view(),a.getFont()),this.fTextField.setBounds(this.fieldBounds(a),a.getText()),this.fTypingTarget=a},TextTool.prototype.mouseDown=function(a,b,c){var d,e=null;if(null==this.fTextField||!this.fTextField.isShown()||!this.fTextField.getBounds().inside(b,c)){if(d=this.drawing().findFigureInside(b,c),d instanceof TextFigure&&(e=d,e.acceptsTyping()||(e=null)),null!=e)return void this.beginEdit(e);null!=this.fTypingTarget?(this.editor().toolDone(),this.endEdit()):(this.creationToolMouseDown(a,b,c),e=this.createdFigure(),this.beginEdit(e),this.fireViewEvent(this.fTypingTarget,"Create")),this.view().drawDrawing()}},TextTool.prototype.mouseDrag=function(a,b,c){},TextTool.prototype.mouseUp=function(a,b,c){},FontSizeHandle.prototype=new LocatorHandle,FontSizeHandle.prototype.initFontSizeHandle=function(a,b){this.initLocatorHandle(a,b)},FontSizeHandle.prototype.createSVGContent=function(a){var b=this.displayBox();a.setColor(this.color),this.shape=a.drawOval(b.x+b.width/2,b.y+b.height/2,b.width,b.height),this.shape.setStrokeWidth(.5),this.shape.setStrokeColor("black"),this.shape.setCursor(this.getCursorName())},FontSizeHandle.prototype.invokeStart=function(a,b,c){var d=this.owner();this.fFont=d.getFont(),this.fSize=this.fFont.getSizeValue()},FontSizeHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner(),g=this.fSize+b-d;g>5&&f.setFont(new Font(this.fFont.getName(),this.fFont.getStyle(),g+"pt"))},PolyLineHandle.prototype=new LocatorHandle,PolyLineHandle.prototype.initPolyLineHandle=function(a,b,c){this.initLocatorHandle(a,b),this.fIndex=c},PolyLineHandle.prototype.invokeStart=function(a,b,c){this.fAnchor=new Point(a,b)},PolyLineHandle.prototype.invokeStep=function(a,b,c,d,e){this.myOwner().setPointAt(new Point(a,b),this.fIndex)},PolyLineHandle.prototype.myOwner=function(){return this.owner()},PolyLineLocator.prototype=new AbstractLocator,PolyLineLocator.prototype.initPolyLineLocator=function(a){this.fIndex=a},PolyLineLocator.prototype.locate=function(a){var b=a;return this.fIndex<b.pointCount()?a.pointAt(this.fIndex):new Point(0,0)},LineFigure.prototype=new PolyLineFigure,LineFigure.prototype.initLineFigure=function(){this.initPolyLineFigure(0,0),this.addPoint(0,0)},LineFigure.prototype.startPoint=function(a,b){return void 0==a||void 0==b?this.pointAt(0):void this.setPointAt(new Point(a,b),0)},LineFigure.prototype.endPoint=function(a,b){return void 0==a||void 0==b?this.pointAt(1):void this.setPointAt(new Point(a,b),1)},LineFigure.prototype.setPoints=function(a,b){this.setPointAt(a,0),this.setPointAt(b,1)},LineFigure.prototype.basicDisplayBox=function(a,b){this.setPoints(a,b)},LineFigure.prototype.createSVGContent=function(a){this.shape=a.drawLine(this.startPoint().x,this.startPoint().y,this.startPoint().x+100,this.startPoint().y+100),this.updatePolyLineAttributes()},LineFigure.prototype.draw=function(a){this.drawLineFigure(a)},LineFigure.prototype.drawLineFigure=function(a){this.drawAbstractFigure(a);var b=this.startPoint(),c=this.endPoint();this.shape.x=b.x,this.shape.y=b.y,this.shape.x2=c.x,this.shape.y2=c.y,this.shape.update()},LineFigure.prototype.handles=function(){for(var a=new Vector(this.fPoints.size()),b=0;b<this.fPoints.size();b++)a.addElement(new PolyLineHandle(this,this.locator(b),b));return a},LineFigure.prototype.clone=function(){return new LineFigure(!0)},LineFigure.prototype.serialize=function(){return this.serializeLineFigure()},LineFigure.prototype.serializeLineFigure=function(){var a=new Hashtable,b=this.startPoint(),c=this.endPoint();return a.put("x1",b.getX()),a.put("y1",b.getY()),a.put("x2",c.getX()),a.put("y2",c.getY()),this.serializePolyLineFigure()+a.serialize()},LineFigure.prototype.deserialize=function(a){return this.deserializeLineFigure(a)},LineFigure.prototype.deserializeLineFigure=function(a){var b=this.deserializePolyLineFigure(a),c=parseFloat(b.get("x1")),d=parseFloat(b.get("y1")),e=parseFloat(b.get("x2")),f=parseFloat(b.get("y2"));return this.startPoint(c,d),this.endPoint(e,f),b},LineFigure.prototype.serializeAsRDF=function(a,b){return this.serializeAsRDFLineFigure(a,b)},LineFigure.prototype.serializeAsRDFLineFigure=function(a,b){var c=this.shape.getNode().nodeName,d="<"+a+c+"_"+this.myCount+"/historyNode_"+this.historyNodeCounter+"> ",e=this.startPoint(),f=this.endPoint(),g="";return g+=d+" svg:x1 "+e.getX()+" . ",g+=d+" svg:y1 "+e.getY()+" . ",g+=d+" svg:x2 "+f.getX()+" . ",g+=d+" svg:y2 "+f.getY()+" . ",g=this.serializeAsRDFPolyLineFigure(a,b)+g},BorderDecorator.prototype=new DecoratorFigure,BorderDecorator.prototype.initBorderDecorator=function(a){this.initDecoratorFigure(a)},BorderDecorator.prototype.border=function(){return new Point(3,3)},BorderDecorator.prototype.createSVGContent=function(a){var b=this.displayBox();this.shape=a.drawStepBorder(b.x,b.y,b.width,b.height)},BorderDecorator.prototype.draw=function(a){this.drawBorderDecorator(a)},BorderDecorator.prototype.drawBorderDecorator=function(a){this.drawDecoratorFigure(a);var b=this.displayBox();this.shape.setSize(b.width,b.height),this.shape.translate(b.x,b.y)},BorderDecorator.prototype.connectionInsets=function(){return this.connectionInsetsBorderDecorator()},BorderDecorator.prototype.connectionInsetsBorderDecorator=function(){var a=this.connectionInsetsDecoratorFigure();return a.top-=3,a.bottom-=3,a.left-=3,a.right-=3,a},BorderDecorator.prototype.displayBox=function(){var a=this.fComponent.displayBox();return a.grow(this.border().x,this.border().y),a},BorderDecorator.prototype.clone=function(){return new BorderDecorator},BorderTool.prototype=new ActionTool,BorderTool.prototype.initBorderTool=function(a){this.initActionTool(a)},BorderTool.prototype.action=function(a){var b=new BorderDecorator(a);this.drawing().replace(a,b)},GroupFigure.prototype=new CompositeFigure,GroupFigure.prototype.initGroupFigure=function(){this.initCompositeFigure()},GroupFigure.prototype.canConnect=function(){return!1},GroupFigure.prototype.basicDisplayBox=function(a,b){},GroupFigure.prototype.decompose=function(){return new FigureEnumerator(this.fFigures)},GroupFigure.prototype.setAttribute=function(a,b){for(var c=this.figures();c.hasMoreElements();)c.nextFigure().setAttribute(a,b)},GroupFigure.prototype.handles=function(){var a=new Vector;return a.addElement(new GroupHandle(this,relativeLocator.northWest())),a.addElement(new GroupHandle(this,relativeLocator.northEast())),a.addElement(new GroupHandle(this,relativeLocator.southWest())),a.addElement(new GroupHandle(this,relativeLocator.southEast())),a},GroupFigure.prototype.ret_displayBox=function(){for(var a=this.figures(),b=a.nextFigure().displayBox();a.hasMoreElements();)b.add(a.nextFigure().displayBox());return b},GroupHandle.prototype=new NullHandle,GroupHandle.prototype.initGroupHandle=function(a,b){this.initLocatorHandle(a,b)},GroupHandle.prototype.createSVGContent=function(a){var b=this.displayBox();a.setColor("none"),this.shape=a.drawRect(b.x,b.y,b.width,b.height),this.shape.setStrokeWidth(1),this.shape.setStrokeColor("white"),this.shape.setAttribute("shape-rendering","optimizeSpeed"),this.shape.setCursor(this.getCursorName())};var TOO_CLOSE=2;PolygonFigure.prototype=new AttributeFigure,PolygonFigure.prototype.initPolygonFigure=function(a,b){if(this.initAttributeFigure(),a instanceof gPolygon){var c=a;return void(this.fPoly=new gPolygon(c.xpoints,c.ypoints,c.npoints))}this.fPoly=new gPolygon(!0),this.fPoly.addPoint(a,b)},PolygonFigure.prototype.ret_displayBox=function(){return this.bounds(this.fPoly)},PolygonFigure.prototype.isEmpty=function(){return this.fPoly.npoints<3||this.size().width<TOO_CLOSE&&this.size().height<TOO_CLOSE},PolygonFigure.prototype.handles=function(a){(void 0==a||null==a)&&(a=this);for(var b=new Vector(this.fPoly.npoints),c=0;c<this.fPoly.npoints;c++)b.addElement(new PolygonHandle(a,this.locator(c),c));return b},PolygonFigure.prototype.basicDisplayBox=function(a,b){var c=this.displayBox(),d=a.x-c.x,e=a.y-c.y;this.fPoly.translate(d,e),c=this.displayBox();var f=new Point(c.x+c.width,c.y+c.height),g=this.getPolygon();this.scaleRotate(f,g,b)},PolygonFigure.prototype.getPolygon=function(){return new gPolygon(this.fPoly.xpoints,this.fPoly.ypoints,this.fPoly.npoints)},PolygonFigure.prototype.center=function(a){if(void 0==a)return this.center(this.fPoly);for(var b=0,c=0,d=a.npoints,e=0;d>e;e++)b+=a.xpoints[e],c+=a.ypoints[e];return new Point(parseInt(b/d),parseInt(c/d))},PolygonFigure.prototype.points=function(){for(var a=new Vector(this.fPoly.npoints),b=0;b<this.fPoly.npoints;++b)a.addElement(new Point(this.fPoly.xpoints[b],this.fPoly.ypoints[b]));return a.elements()},PolygonFigure.prototype.pointCount=function(){return this.fPoly.npoints},PolygonFigure.prototype.basicMoveBy=function(a,b){this.fPoly.translate(a,b)},PolygonFigure.prototype.createSVGContent=function(a){this.shape=a.drawPolygon(0,0,this.fPoly.xpoints,this.fPoly.ypoints),this.updateShapeAttributes()},PolygonFigure.prototype.draw=function(a){this.drawPolygonFigure(a)},PolygonFigure.prototype.drawPolygonFigure=function(a){this.drawAttributeFigure(a),this.shape.setXYPoints(this.fPoly.xpoints,this.fPoly.ypoints)},PolygonFigure.prototype.containsPoint=function(a,b){return this.fPoly.contains(a,b)},PolygonFigure.prototype.connectorAt=function(a,b){return new ChopPolygonConnector(this)},PolygonFigure.prototype.addPoint=function(a,b){this.fPoly.addPoint(a,b),this.changed()},PolygonFigure.prototype.setPointAt=function(a,b){this.willChange(),this.fPoly.xpoints[b]=a.x,this.fPoly.ypoints[b]=a.y,this.changed()},PolygonFigure.prototype.insertPointAt=function(a,b){this.willChange();for(var c=this.fPoly.npoints+1,d=new Array,e=new Array,f=0;b>f;++f)d[f]=this.fPoly.xpoints[f],e[f]=this.fPoly.ypoints[f];d[b]=a.x,e[b]=a.y;for(var f=b;f<this.fPoly.npoints;++f)d[f+1]=this.fPoly.xpoints[f],e[f+1]=this.fPoly.ypoints[f];this.fPoly=new gPolygon(d,e,c),this.changed()},PolygonFigure.prototype.removePointAt=function(a){this.willChange();for(var b=this.fPoly.npoints-1,c=new Array,d=new Array,e=0;a>e;++e)c[e]=this.fPoly.xpoints[e],d[e]=this.fPoly.ypoints[e];for(var e=a;b>e;++e)c[e]=this.fPoly.xpoints[e+1],d[e]=this.fPoly.ypoints[e+1];this.fPoly=new gPolygon(c,d,b),this.changed()},PolygonFigure.prototype.scaleRotate=function(a,b,c){this.willChange();var d=this.center(b),e=geom.length(d.x,d.y,a.x,a.y);if(e>0){for(var f=geom.length(d.x,d.y,c.x,c.y),g=f/e,h=Math.atan2(a.y-d.y,a.x-d.x),i=Math.atan2(c.y-d.y,c.x-d.x),j=i-h,k=b.npoints,l=new Array,m=new Array,n=0;k>n;++n){var o=b.xpoints[n],p=b.ypoints[n],q=geom.length(d.x,d.y,o,p)*g,r=Math.atan2(p-d.y,o-d.x)+j;l[n]=parseInt(d.x+q*Math.cos(r)+.5),m[n]=parseInt(d.y+q*Math.sin(r)+.5)}this.fPoly=new gPolygon(l,m,k)}this.changed()},PolygonFigure.prototype.smoothPoints=function(){return},PolygonFigure.prototype.splitSegment=function(a,b){var c=this.findSegment(a,b);return-1!=c?(this.insertPointAt(new Point(a,b),c+1),c+1):-1},PolygonFigure.prototype.pointAt=function(a){return new Point(this.fPoly.xpoints[a],this.fPoly.ypoints[a])},PolygonFigure.prototype.outermostPoint=function(){for(var a=this.center(),b=0,c=0,d=0;d<this.fPoly.npoints;++d){var e=geom.length2(a.x,a.y,this.fPoly.xpoints[d],this.fPoly.ypoints[d]);e>c&&(c=e,b=d)}return new Point(this.fPoly.xpoints[b],this.fPoly.ypoints[b])},PolygonFigure.prototype.findSegment=function(a,b){},PolygonFigure.prototype.chop=function(a){return this.chop(this.fPoly,a)},PolygonFigure.prototype.locator=function(a){return new PolygonFigureLocator(a)},PolygonFigureLocator.prototype=new AbstractLocator,PolygonFigureLocator.prototype.locate=function(a){var b=a;return this.pointIndex<b.pointCount()?a.pointAt(this.pointIndex):new Point(-1,-1);

},PolygonFigureLocator.prototype.toString=function(){return this.className},PolygonFigure.prototype.distanceFromLine=function(a,b,c,d,e,f){var g=c-a,h=d-b,i=g*g+h*h;if(0==i)return Geom.length(a,b,e,f);var j=(b-f)*(b-d)-(a-e)*(c-a),k=j/i;if(0>k||k>1)return Number.MAX_VALUE;var l=a+k*g,m=b+k*h,n=e-l,o=f-m;return Math.sqrt(n*n+o*o)},PolygonFigure.prototype.bounds=function(a){for(var b=Number.MAX_VALUE,c=Number.MAX_VALUE,d=Number.MIN_VALUE,e=Number.MIN_VALUE,f=a.npoints,g=0;f>g;g++){var h=a.xpoints[g],i=a.ypoints[g];h>d&&(d=h),b>h&&(b=h),i>e&&(e=i),c>i&&(c=i)}return new gRectangle(b,c,d-b,e-c)},PolygonFigure.prototype.chop=function(a,b){},PolygonFigure.prototype.write=function(a){},PolygonFigure.prototype.read=function(a){},PolygonFigure.prototype.clone=function(){return new PolygonFigure(0,0)},PolygonFigure.prototype.serialize=function(){return this.serializePolygonFigure()},PolygonFigure.prototype.serializePolygonFigure=function(){var a=new Hashtable;return a.put("points",this.fPoly.serialize()),this.serializeAttributeFigure()+a.serialize()},PolygonFigure.prototype.deserialize=function(a){return this.deserializePolygonFigure(a)},PolygonFigure.prototype.deserializePolygonFigure=function(a){var b=this.deserializeAttributeFigure(a);return this.fPoly=new gPolygon(!0),this.fPoly.deserialize(b.get("points")),b},PolygonFigure.prototype.serializeAsRDF=function(a,b){return this.serializeAsRDFPolygonFigure(a,b)},PolygonFigure.prototype.serializeAsRDFPolygonFigure=function(a,b){var c=this.shape.getNode().nodeName,d="<"+a+c+"_"+this.myCount+"/historyNode_"+this.historyNodeCounter+"> ",e=d+' svg:points "'+this.fPoly.serialize()+'" . ';return e=this.serializeAsRDFAttributeFigure(a,b)+e},PolygonHandle.prototype=new AbstractHandle,PolygonHandle.prototype.initPolygonHandle=function(a,b,c){this.initAbstractHandle(a),this.fLocator=b,this.fIndex=c},PolygonHandle.prototype.invokeStep=function(a,b,c,d,e){this.myOwner().setPointAt(new Point(a,b),this.fIndex)},PolygonHandle.prototype.invokeEnd=function(a,b,c,d,e){this.myOwner().smoothPoints()},PolygonHandle.prototype.myOwner=function(){return this.owner()},PolygonHandle.prototype.locate=function(){return this.fLocator.locate(this.owner())},PolygonTool.prototype=new AbstractTool,PolygonTool.prototype.initPolygonTool=function(a){this.initAbstractTool(a)},PolygonTool.prototype.activate=function(){this.activatePolygonTool()},PolygonTool.prototype.activatePolygonTool=function(){this.activateAbstractTool(),this.view().setCursor("crosshair"),this.view().clearSelection(),this.fPolygon=null},PolygonTool.prototype.deactivate=function(){this.deactivatePolygonTool()},PolygonTool.prototype.deactivatePolygonTool=function(){this.deactivateAbstractTool(),null!=this.fPolygon&&(this.fPolygon.pointCount()<3||this.fPolygon.size().width<4||this.fPolygon.size().height<4)&&this.drawing().remove(this.fPolygon),this.fPolygon=null},PolygonTool.prototype.addPoint=function(a,b){null==this.fPolygon?(this.fPolygon=new PolygonFigure(a,b),this.view().add(this.fPolygon),this.fPolygon.addPoint(a,b)):(this.fLastX!=a||this.fLastY!=b)&&this.fPolygon.addPoint(a,b),this.fLastX=a,this.fLastY=b},PolygonTool.prototype.mouseDown=function(a,b,c){b=a.getX(),c=a.getY(),a.getClickCount()>=2?(null!=this.fPolygon&&(this.fPolygon.smoothPoints(),this.fireViewEvent(this.fPolygon,"Create"),this.editor().toolDone()),this.fPolygon=null):this.addPoint(a.getX(),a.getY())},PolygonTool.prototype.mouseMove=function(a,b,c){null!=this.fPolygon&&this.fPolygon.pointCount()>1&&this.fPolygon.setPointAt(new Point(b,c),this.fPolygon.pointCount()-1)},PolygonTool.prototype.mouseDrag=function(a,b,c){null!=this.fPolygon&&this.addPoint(a.getX(),a.getY())},PolygonTool.prototype.mouseUp=function(a,b,c){},PolygonScaleHandle.prototype=new AbstractHandle,PolygonScaleHandle.prototype.initPolygonScaleHandle=function(a){this.initAbstractHandle(a),this.color="green"},PolygonScaleHandle.prototype.createSVGContent=function(a){var b=this.displayBox();a.setColor(this.color),this.shape=a.drawOval(b.x+b.width/2,b.y+b.height/2,b.width,b.height),this.shape.setStrokeWidth(.5),this.shape.setStrokeColor("black"),this.shape.setCursor(this.getCursorName())},PolygonScaleHandle.prototype.locate=function(){return null!=this.fCurrent?this.fCurrent:this.getOrigin()},PolygonScaleHandle.prototype.invokeStart=function(a,b,c){this.fOrigPoly=this.owner().getPolygon(),this.fOrigin=this.getOrigin(),this.fCurrent=new Point(this.fOrigin.x,this.fOrigin.y)},PolygonScaleHandle.prototype.invokeStep=function(a,b,c){this.fCurrent=new Point(this.fOrigin.x+a,this.fOrigin.y+b),this.owner().scaleRotate(this.fOrigin,this.fOrigPoly,this.fCurrent)},PolygonScaleHandle.prototype.invokeEnd=function(a,b,c){this.fOrigPoly=null,this.fOrigin=null,this.fCurrent=null},PolygonScaleHandle.prototype.getOrigin=function(a,b,c){var d=this.owner().outermostPoint(),e=this.owner().center(),f=geom.length(d.x,d.y,e.x,e.y);if(0==f)return new Point(d.x-this.HANDLESIZE/2,d.y+this.HANDLESIZE/2);var g=this.HANDLESIZE/f;return g>1?new Point((3*d.x+e.x)/4,(3*d.y+e.y)/4):new Point(parseInt(d.x*(1-g)+e.x*g),parseInt(d.y*(1-g)+e.y*g))},FloatingTextArea.prototype.initFloatingTextArea=function(){this.fEditWidget=new TextBox(0,0,400,300,"Musbah",viewerMode==ASV),this.fEditWidget.setAbsolutePosition(!0)},FloatingTextArea.prototype.createOverlay=function(a,b){return void 0==b?void this.createOverlay(a,null):(a.add(this.fEditWidget),this.fEditWidget.show(),null!=b&&this.fEditWidget.setFont(b),this.fContainer=a,void this.fContainer.paintChildren(this.fContainer.textBoxg))},FloatingTextArea.prototype.setBounds=function(a,b){var c=a.getWidth(),d=a.getHeight();this.fEditWidget.setBounds(a.x,a.y,c,d),this.fEditWidget.show(),this.fEditWidget.setText(b),this.fEditWidget.selectAll()},FloatingTextArea.prototype.getBounds=function(){return this.fEditWidget.getBounds()},FloatingTextArea.prototype.isShown=function(){return this.fEditWidget.isShown()},FloatingTextArea.prototype.endOverlay=function(){null!=this.fEditWidget&&(this.fEditWidget.hide(),this.fContainer.remove(this.fEditWidget))},FloatingTextArea.prototype.addActionListener=function(a){this.fEditWidget.addActionListener(a)},FloatingTextArea.prototype.removeActionListener=function(a){this.fEditWidget.removeActionListener(a)},FloatingTextArea.prototype.getText=function(){return this.fEditWidget.getText()},FloatingTextArea.prototype.getPreferredSize=function(a){return new Dimension(this.fEditWidget.getWidth(),this.fEditWidget.getHeight())},TextAreaTool.prototype=new CreationTool,TextAreaTool.prototype.initTextAreaTool=function(a,b){this.initCreationTool(a,b)},TextAreaTool.prototype.activate=function(){this.activateTextAreaTool()},TextAreaTool.prototype.activateTextAreaTool=function(){this.activateCreationTool(),this.view().setCursor("text")},TextAreaTool.prototype.deactivate=function(){this.deactivateTextAreaTool()},TextAreaTool.prototype.deactivateTextAreaTool=function(){this.deactivateCreationTool(),this.endEdit()},TextAreaTool.prototype.fieldBounds=function(a){var b=a.displayBox();return new gRectangle(b.x,b.y,b.width,b.height)},TextAreaTool.prototype.endEdit=function(a){null!=this.fTypingTarget&&(this.fTextAreaField.getText().length>0?this.fTypingTarget.setText(this.fTextAreaField.getText()):this.drawing().remove(this.fTypingTarget),this.fTypingTarget=null,this.fTextAreaField.endOverlay())},TextAreaTool.prototype.beginEdit=function(a){null==this.fTextAreaField&&(this.fTextAreaField=new FloatingTextArea),a!=this.fTypingTarget&&null!=this.fTypingTarget&&this.endEdit(),this.fTextAreaField.createOverlay(this.view(),a.getFont()),this.fTextAreaField.setBounds(this.fieldBounds(a),a.getText()),this.fTypingTarget=a},TextAreaTool.prototype.mouseDown=function(a,b,c){var d,e=null;if(null==this.fTextAreaField||!this.fTextAreaField.isShown()||!this.fTextAreaField.getBounds().inside(b,c)){if(d=this.drawing().findFigureInside(b,c),d instanceof TextAreaDecorator&&(e=d,e.acceptsTyping()||(e=null)),null!=e)return void this.beginEdit(e);if(null!=this.fTypingTarget)this.editor().toolDone(),this.endEdit();else{if((d instanceof EllipseFigure||d instanceof RectangleFigure||d instanceof RoundRectangleFigure||d instanceof PolygonFigure)&&!(d instanceof ImageFigure))return e=this.createFigure(),e.decorate(d),this.drawing().replace(d,e),void this.editor().toolDone();null!=d&&alert("Invalid Figure Type :"+d),this.editor().toolDone()}this.view().drawDrawing()}},TextAreaTool.prototype.mouseDrag=function(a,b,c){},TextAreaTool.prototype.mouseUp=function(a,b,c){},OpacityHandle.prototype=new LocatorHandle,OpacityHandle.prototype.initOpacityHandle=function(a,b){this.initLocatorHandle(a,b),this.color="Teal"},OpacityHandle.prototype.invokeStart=function(a,b,c){this.owner();this.opacity=0},OpacityHandle.prototype.invokeStep=function(a,b,c,d,e){var f=this.owner(),g=this.opacity+b-d;g>this.max&&(g=this.max),g<this.min&&(g=this.min),g=(g-this.min)/(this.max-this.min),f.setOpacity(g)},TextAlignHandle.prototype=new LocatorHandle,TextAlignHandle.prototype.initTextAlignHandle=function(a,b){this.initLocatorHandle(a,b),this.color="olive"},TextAlignHandle.prototype.invokeStart=function(a,b,c){var d=this.owner();d.setTextAlign(this.textAlign[this.counter]),this.counter++,this.counter>3&&(this.counter=0)},TextAlignHandle.prototype.invokeStep=function(a,b,c,d,e){},TextAreaDecorator.prototype=new DecoratorFigure,TextAreaDecorator.prototype.initTextAreaDecorator=function(a){this.initDecoratorFigure(a),this.setAttribute("FrameColor","none"),this.setAttribute("FillColor","black")},TextAreaDecorator.prototype.border=function(){return new Point(0,0)},TextAreaDecorator.prototype.getOpacity=function(){return this.fComponent.shape.getOpacity()},TextAreaDecorator.prototype.setOpacity=function(a){this.fComponent.shape.setOpacity(a)},TextAreaDecorator.prototype.setTextAlign=function(a){this.shape.setTextAlign(a)},TextAreaDecorator.prototype.handles=function(){return this.handlesTextAreaDecorator()},TextAreaDecorator.prototype.handlesTextAreaDecorator=function(){var a=this.handlesDecoratorFigure();return a.addElement(new FontSizeHandle(this,new RelativeLocator(.5,.5))),a.addElement(new OpacityHandle(this,new RelativeLocator(.45,.5))),a.addElement(new TextAlignHandle(this,new RelativeLocator(.55,.5))),a},TextAreaDecorator.prototype.createSVGContent=function(a){var b=this.displayBox();this.shape=a.drawTextView(0,0,b.width,b.height,null,this.fComponent.shape),this.para=this.shape.addParagraph(this.fText),this.updateShapeAttributes()},TextAreaDecorator.prototype.draw=function(a){this.drawTextAreaDecorator(a)},TextAreaDecorator.prototype.drawTextAreaDecorator=function(a){this.drawDecoratorFigure(a),this.shape.setFont(this.getFont()),this.shape.updateRegionShapeProperties(this.fComponent.shape)},TextAreaDecorator.prototype.updateShapeAttributes=function(){this.updateShapeAttributesTextAreaDecorator()},TextAreaDecorator.prototype.updateShapeAttributesTextAreaDecorator=function(){this.isCreated()&&this.shape.setFont(this.getFont()),this.isCreated()&&this.shape.setColor(this.getAttribute("FillColor")),this.isCreated()&&this.shape.setStrokeColor(this.getAttribute("FrameColor")),this.isCreated()&&this.shape.setOpacity(this.getAttribute("Opacity")),this.isCreated()&&this.shape.setStrokeWidth(this.getAttribute("FrameWidth")),null!=this.FComponent&&(this.fComponent.isCreated()&&this.fComponent.shape.setColor(this.getAttribute("FillColor")),this.fComponent.isCreated()&&this.fComponent.shape.setStrokeColor(this.getAttribute("FrameColor")),this.fComponent.isCreated()&&this.fComponent.shape.setOpacity(this.getAttribute("Opacity")),this.fComponent.isCreated()&&this.fComponent.shape.setStrokeWidth(this.getAttribute("FrameWidth")))},TextAreaDecorator.prototype.connectionInsets=function(){return this.connectionInsetsTextAreaDecorator()},TextAreaDecorator.prototype.connectionInsetsTextAreaDecorator=function(){var a=this.connectionInsetsDecoratorFigure();return a},TextAreaDecorator.prototype.displayBox=function(){var a=this.fComponent.displayBox();return a.grow(this.border().x,this.border().y),a},TextAreaDecorator.prototype.getFont=function(){return this.fFont},TextAreaDecorator.prototype.setFont=function(a){this.willChange(),this.fFont=a,this.shape.setFont(this.fFont),this.changed()},TextAreaDecorator.prototype.changed=function(){},TextAreaDecorator.prototype.createCurrentFont=function(){return new Font(this.fgCurrentFontName,this.fgCurrentFontStyle,this.fgCurrentFontSize+"pt")},TextAreaDecorator.prototype.setCurrentFontName=function(a){this.fgCurrentFontName=a},TextAreaDecorator.prototype.setCurrentFontSize=function(a){this.fgCurrentFontSize=a},TextAreaDecorator.prototype.setCurrentFontStyle=function(a){this.fgCurrentFontStyle=a},TextAreaDecorator.prototype.getAttribute=function(a){var b=this.getFont();return"FontSize"==a?b.getSize():"FontStyle"==a?b.getStyle():"FontName"==a?b.getName():this.getAttributeAttributeFigure(a)},TextAreaDecorator.prototype.setAttribute=function(a,b){var c=this.getFont();"FontSize"==a?this.setFont(new Font(c.getName(),c.getNamedStyle(),parseInt(b))):"FontStyle"==a?(c.setStyle(parseInt(b)),this.setFont(new Font(c.getName(),c.getNamedStyle(),c.getSize()))):"FontName"==a?this.setFont(new Font(b,c.getNamedStyle(),c.getSize())):this.setAttributeAttributeFigure(a,b)},TextAreaDecorator.prototype.getText=function(){return this.fText},TextAreaDecorator.prototype.setText=function(a){a!=this.fText&&(this.willChange(),this.fText=a,null!=this.para&&this.para.setText(a),this.changed())},TextAreaDecorator.prototype.findFigureInside=function(a,b){return this.containsPoint(a,b)?this:null},TextAreaDecorator.prototype.acceptsTyping=function(){return!this.fIsReadOnly},TextAreaDecorator.prototype.clone=function(){return new TextAreaDecorator(null)},DrawApplication.prototype.open=function(a,b,c,d,e){this.openDrawApplication(a,b,c,d)},DrawApplication.prototype.openDrawApplication=function(a,b,c,d,e){this.width=c,this.height=d;var f=11,g=28*f;this.tools=new Window(innerWidth-50-g,10,23+g,55,e,null,!1),this.tools.setToFixedSize(),this.tools.setLayout(new FlowLayout(CENTER)),this.fView=this.createDrawingView(),this.fView.translate(a,b),this.createTools(this.tools),this.tools.paint(),this.fStatusLine=this.createStatusLine(this.tools);this.defaultSize();this.initDrawing(),this.tools.putWindowOnTop()},DrawApplication.prototype.initDrawing=function(){this.fDrawing=this.createDrawing(),this.fDrawingFilename=this.fgUntitled,this.fView.setDrawing(this.fDrawing),this.toolDone()},DrawApplication.prototype.createDrawingView=function(){var a=this.getDrawingViewSize();return new StandardDrawingView(this,a.width,a.height)},DrawApplication.prototype.createTools=function(a){this.createToolsDrawApplication(a)},DrawApplication.prototype.createToolsDrawApplication=function(a){var b=this.createSelectionTool();this.fDefaultToolButton=this.createToolButton(this.IMAGES+"SEL","Selection Tool",b),a.add(this.fDefaultToolButton)},DrawApplication.prototype.createSelectionTool=function(){return new SelectionTool(this.view())},DrawApplication.prototype.createToolButton=function(a,b,c){return new ToolButton(this,a,b,c)},DrawApplication.prototype.getDrawingViewSize=function(){return new Dimension(this.width,this.height)},DrawApplication.prototype.createDrawing=function(){return new StandardDrawing(!0)},DrawApplication.prototype.setDrawing=function(a){this.fView.setDrawing(a),this.fDrawing=a},DrawApplication.prototype.defaultSize=function(){return new Dimension(430,406)},DrawApplication.prototype.drawing=function(){return this.fDrawing},DrawApplication.prototype.tool=function(){return this.fTool},DrawApplication.prototype.view=function(){return this.fView},DrawApplication.prototype.toolDone=function(){null!=this.fDefaultToolButton&&(this.setTool(this.fDefaultToolButton.tool(),this.fDefaultToolButton.name()),this.setSelected(this.fDefaultToolButton))},DrawApplication.prototype.selectionChanged=function(a){},DrawApplication.prototype.setTool=function(a,b){null!=this.fTool&&this.fTool.deactivate(),this.fTool=a,null!=this.fTool&&(this.showStatus(b),this.fTool.activate())},DrawApplication.prototype.paletteUserSelected=function(a){var b=a;this.setTool(b.tool(),b.name()),this.setSelected(b)},DrawApplication.prototype.setSelected=function(a){null!=this.fSelectedToolButton&&this.fSelectedToolButton.reset(),this.fSelectedToolButton=a,null!=this.fSelectedToolButton&&this.fSelectedToolButton.select()},DrawApplication.prototype.paletteUserOver=function(a,b){var c=a;b?this.showStatus(c.name()):null!=this.fSelectedToolButton&&this.showStatus(this.fSelectedToolButton.name())},DrawApplication.prototype.showStatus=function(a){this.fStatusLine.setText(a)},DrawApplication.prototype.createStatusLine=function(a){var b=a.getWidth()-a.left-a.right,c=24;a.setSize(a.getWidth(),a.h+c);var d=a.getGraphics(),e=a.left,f=a.getHeight()-a.bottom-c,g=d.drawStepBorder(e+3,f+3,b-6,c-6);g.setFaceDown(),d.setColor("black"),d.setFont(new Font("Helvetica","normal","10pt"));var h=d.drawText(e+5,f+3," ");return h.setToBaseLine(),h},DemoDrawingView.prototype=new StandardDrawingView,DemoDrawingView.prototype.initDemoDrawingView=function(a,b,c){this.initStandardDrawingView(a,b,c),this.addMenuItem("Attributes");var d=this.popUpMenu;this.popUpMenu=null,this.addMenuItem("Send To Front"),this.addMenuItem("Send To Back"),this.addMenuSeparator(),this.addMenuItem("Delete"),this.addMenuItem("Duplicate"),this.addMenuItem("Group"),this.addMenuItem("Ungroup"),this.addMenuSeparator(),this.addMenuItem("Attributes"),this.popUpMenu2=this.popUpMenu,this.popUpMenu=d},DemoDrawingView.prototype.createSVGContent=function(){this.createSVGContentDemoDrawingView()},DemoDrawingView.prototype.createSVGContentDemoDrawingView=function(){this.createSVGContentStandardDrawingView(),null!=this.popUpMenu2&&(this.popUpMenu2.paint(),menuLayer.addGraphics(this.popUpMenu2),this.popUpMenu2.hide())},DemoDrawingView.prototype.recalc=function(){this.recalcDemoDrawingView()},DemoDrawingView.prototype.recalcDemoDrawingView=function(){this.recalcStandardDrawingView(),null!=this.popUpMenu2&&this.popUpMenu2.recalc()},DemoDrawingView.prototype.mousePressed=function(a){this.mousePressedDemoDrawingView(a)},DemoDrawingView.prototype.mousePressedDemoDrawingView=function(a){if(!a.isAltDown()&&!a.isControlDown()){this.mousePressedStandardDrawingView(a);var b=this.drawing().findFigure(a.getX(),a.getY()),c=this.getAbsoluteLocation();if(a.getButton()==BUTTON2){var d=null,e=c.x+a.getX()+5,f=c.y+a.getY()+5;if(null!=b&&this.selection().contains(b)&&null!=this.popUpMenu2?(d=this.popUpMenu2,this.targetFigure=b):null!=this.popUpMenu&&(d=this.popUpMenu,this.clearSelection()),null!=d){var g=d.getWidth(),h=d.getHeight();e+g>innerWidth&&(e=e-g-10),f+h>innerHeight&&(f=f-h-10),d.translate(e,f),d.show()}}}},DemoDrawingView.prototype.econtMousePressed=function(a){var b=this.getComponentAt(a.getX(),a.getY());this.pressX=a.getX(),this.pressY=a.getY(),this.isEventable(b)&&this.fireMouseEventToComponent(b,"mousePressed",a)},DemoDrawingView.prototype.actionPerformed=function(a){var b=a.source,c=a.getActionCommand();if("menuItemSelected"==c)switch(b.name){case"Send To Front":this.sendSelectionToFront();break;case"Send To Back":this.sendSelectionToBack();break;case"Delete":var d=new DeleteCommand("Delete",this);d.execute();break;case"Duplicate":var d=new DuplicateCommand("Duplicate",this);d.execute();break;case"Group":var d=new GroupCommand("Group",this);d.execute();break;case"Ungroup":var d=new UngroupCommand("Ungroup",this);d.execute();break;case"Attributes":this.editor().attributesWindow.show(),this.editor().selectionChanged(this.editor().view())}if(null!=this.actionListeners)for(var e=new Enumerator(this.actionListeners);e.hasMoreElements();)e.nextElement().actionPerformed(a)},DemoApplication.prototype=new DrawApplication,DemoApplication.prototype.open=function(a,b,c,d){this.openDemoApplication(a,b,c,d),this.attributesWindow=new DemoAttributes(10,10),this.attributesWindow.paint(),this.attributesWindow.hide()},DrawApplication.prototype.createDrawingView=function(){var a=this.getDrawingViewSize();return new DemoDrawingView(this,a.width,a.height)},DemoApplication.prototype.openDemoApplication=function(a,b,c,d){this.openDrawApplication(a,b,c,d,"SVG Hotdraw Demo v1.0: Tools,..")},DemoApplication.prototype.createTools=function(a){this.createToolsDemoApplication(a)},DemoApplication.prototype.createToolsDemoApplication=function(a){this.createToolsDrawApplication(a);var b;b=new TextTool(this.view(),new TextFigure),a.add(this.createToolButton(this.IMAGES+"TEXT","Text Tool",b)),b=new CreationTool(this.view(),new ImageFigure),a.add(this.createToolButton(this.IMAGES+"IMAGE","Image Tool",b)),b=new CreationTool(this.view(),new RectangleFigure),a.add(this.createToolButton(this.IMAGES+"RECT","Rectangle Tool",b)),b=new CreationTool(this.view(),new EllipseFigure),a.add(this.createToolButton(this.IMAGES+"ELLIPSE","Ellipse Tool",b)),b=new CreationTool(this.view(),new RoundRectangleFigure),a.add(this.createToolButton(this.IMAGES+"RRECT","Round Rectangle Tool",b)),b=new PolygonTool(this.view()),a.add(this.createToolButton(this.IMAGES+"POLYGON","Polygon Tool",b)),b=new CreationTool(this.view(),new LineFigure),a.add(this.createToolButton(this.IMAGES+"LINE","Line Tool",b)),b=new ScribbleTool(this.view()),a.add(this.createToolButton(this.IMAGES+"SCRIBBL","Scribble Tool",b)),b=new BorderTool(this.view()),a.add(this.createToolButton(this.IMAGES+"BORDDEC","Border Tool",b)),b=new TextAreaTool(this.view(),new TextAreaDecorator),a.add(this.createToolButton(this.IMAGES+"TEXTAREA","TextArea Decorator Tool",b))},DemoApplication.prototype.actionPerformed=function(a){var b=a.source,c=a.getActionCommand();if("menuItemSelected"==c)switch(b.name){case"Tools":this.tools.show()}},DemoApplication.prototype.recalc=function(){this.view().recalc(),null!=this.tools&&this.tools.recalc(),null!=this.attributesWindow&&(this.attributesWindow.show(),this.attributesWindow.recalc(),this.attributesWindow.hide())},DemoApplication.prototype.selectionChanged=function(a){null==this.attributesWindow||this.attributesWindow.isHidden()||this.attributesWindow.open(a.selectionZOrdered())},DemoApplication.prototype.toString=function(){return"DemoApplication"},DemoAttributes.prototype=new Window,DemoAttributes.prototype.initDemoAttributes=function(a,b){this.initWindow(a,b,this.cw,this.ch,"Attributes & Commands",null,!0),this.setLayout(new FlowLayout(LEFT)),this.setToFixedSize(),this.tabbedPane=new TabbedPane(50,20,this.cw-20,this.ch-45),this.tabbedPane.setFont(this.getFont()),this.tabbedPane.setAlign(X_AXIS,LEFT,TOP,2),this.image=this.tabbedPane.addPane("pane3"," Image "),this.attributes=this.tabbedPane.addPane("pane1"," Attributes "),this.attributes.setLayout(new FlowLayout(LEFT,5,5)),this.image.setLayout(new FlowLayout(LEFT,5,5)),this.attributes.setInsets(3,3,7,3),this.image.setInsets(3,3,7,3),this.fillColorLabel=new Label(0,0,0,0,"fillColor","Fill:"),this.attributes.add(this.fillColorLabel),this.fillColorComboBox=new ColorComboBox("fillColorComboBox"),this.attributes.add(this.fillColorComboBox).addActionListener(this),this.strokeColorLabel=new Label(0,0,0,0,"strokeColor","Pen:"),this.attributes.add(this.strokeColorLabel),this.strokeColorComboBox=new ColorComboBox("strokeColorComboBox"),this.attributes.add(this.strokeColorComboBox).addActionListener(this),this.attributes.add(new Label(0,0,0,0,"font","Font:")),this.fontComboBox=new ComboBox(0,0,0,0,"fontComboBox"),this.fontComboBox.setFont(this.getFont()),this.fontComboBox.addTextItem("Times New Roman"),this.fontComboBox.addTextItem("Monotype Corsiva"),this.fontComboBox.addTextItem("Comic Sans MS"),this.fontComboBox.addTextItem("Sans-serif"),this.fontComboBox.addTextItem("Helvetica"),this.fontComboBox.addTextItem("Monospace"),this.fontComboBox.addTextItem("Marigold"),this.fontComboBox.addTextItem("Georgia"),this.fontComboBox.addTextItem("Arial"),this.attributes.add(this.fontComboBox).addActionListener(this),this.image.add(new Label(0,0,0,0,"url","URL:")),this.imageURL=new TextBox(0,0,this.cw-90,100,"",!1),this.image.add(this.imageURL).setFont(this.getFont()),this.image.add(new Button(0,0,0,0,"applyURL","  Apply   ")).addActionListener(this),this.add(this.tabbedPane)},DemoAttributes.prototype.paint=function(a){this.paintDemoAttributes(a)},DemoAttributes.prototype.paintDemoAttributes=function(a){this.paintComponent(a)},DemoAttributes.prototype.open=function(a){if(this.selected=a,a.size()<=0)return this.changeStrokeColor("none"),this.changeFillColor("none"),void this.changeImageURL("");var b=this.selected.elementAt(0);b instanceof ImageFigure?(this.changeStrokeColor("none"),this.changeFillColor("none"),this.changeImageURL(b.getURL())):(this.changeStrokeColor(b.getAttribute("FrameColor")),this.changeFillColor(b.getAttribute("FillColor")),this.changeImageURL("")),(b instanceof TextFigure||this.figure instanceof TextAreaDecorator)&&this.changeFontName(b.getFont())},DemoAttributes.prototype.recalc=function(){this.recalcDemoAttributes()},DemoAttributes.prototype.recalcDemoAttributes=function(){this.recalcWindow()},DemoAttributes.prototype.changeFontName=function(a){this.fontComboBox.changeToText(a.getName())},DemoAttributes.prototype.changeStrokeColor=function(a){this.strokeColorComboBox.changeToColor(a)},DemoAttributes.prototype.changeFillColor=function(a){this.fillColorComboBox.changeToColor(a)},DemoAttributes.prototype.changeImageURL=function(a){this.imageURL.setText(a)},DemoAttributes.prototype.getImageURL=function(){return this.imageURL.getText()},DemoAttributes.prototype.actionPerformed=function(a){this.actionPerformedDemoAttributes(a)},DemoAttributes.prototype.actionPerformedDemoAttributes=function(a){this.actionPerformedWindow(a);var b=a.source,c=a.getActionCommand();if(!(this.selected.size()<=0)){if("itemClicked"==c){var d=b.name;"fillColorComboBox"==d&&this.setAttributeToSelected("FillColor",b.getCurrentComponent().getColor()),"strokeColorComboBox"==d&&this.setAttributeToSelected("FrameColor",b.getCurrentComponent().getColor()),"fontComboBox"==d&&this.setAttributeToSelected("FontName",b.getCurrentComponent().name)}if("buttonClicked"==c&&"applyURL"==b.name)for(var e=new Enumerator(this.selected);e.hasMoreElements();){var f=e.nextElement();f instanceof ImageFigure&&f.setURL(this.getImageURL())}}},DemoAttributes.prototype.setAttributeToSelected=function(a,b){for(var c=new Enumerator(this.selected);c.hasMoreElements();)c.nextElement().setAttribute(a,b)};var demoApplication;